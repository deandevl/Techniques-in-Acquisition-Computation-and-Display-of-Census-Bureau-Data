<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-11-15">

<title>spatial_analysis_with_census</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>

<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">

<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>

<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>

<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">

<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>

<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>

<script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>

<link href="site_libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">

<script src="site_libs/HomeButton-0.0.1/home-button.js"></script>

<script src="site_libs/HomeButton-0.0.1/easy-button-src.min.js"></script>

<script src="site_libs/clipboard-0.0.1/setClipboardText.js"></script>

<link href="site_libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">

<link href="site_libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">

<link href="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet">

<script src="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>

<link href="site_libs/ionicons-2.0.1/ionicons.min.css" rel="stylesheet">



<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_intro_to_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 An introduction to tidyverse</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_wrangling_census_data_with_tidyverse_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Wrangling Census Data with tidyverse tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_exploring_census_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Exploring US Census data with visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_census_geographic_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Census geographic data and applications in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_mapping_census_data_with_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6 Mapping Census data with R</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#spatial-analysis-with-us-census-data" id="toc-spatial-analysis-with-us-census-data" class="nav-link active" data-scroll-target="#spatial-analysis-with-us-census-data">7 Spatial analysis with US Census data</a>
  <ul class="collapse">
  <li><a href="#spatial-overlay" id="toc-spatial-overlay" class="nav-link" data-scroll-target="#spatial-overlay">7.1 Spatial overlay</a>
  <ul class="collapse">
  <li><a href="#note-aligning-coordinate-reference-systems" id="toc-note-aligning-coordinate-reference-systems" class="nav-link" data-scroll-target="#note-aligning-coordinate-reference-systems">7.1.1 Note: aligning coordinate reference systems</a></li>
  <li><a href="#identifying-geometries-within-a-metropolitan-area" id="toc-identifying-geometries-within-a-metropolitan-area" class="nav-link" data-scroll-target="#identifying-geometries-within-a-metropolitan-area">7.1.2 Identifying geometries within a metropolitan area</a></li>
  <li><a href="#spatial-subsets-and-spatial-predicates" id="toc-spatial-subsets-and-spatial-predicates" class="nav-link" data-scroll-target="#spatial-subsets-and-spatial-predicates">7.1.3 Spatial subsets and spatial predicates</a></li>
  </ul></li>
  <li><a href="#spatial-joins" id="toc-spatial-joins" class="nav-link" data-scroll-target="#spatial-joins">7.2 Spatial joins</a>
  <ul class="collapse">
  <li><a href="#point-in-polygon-spatial-joins" id="toc-point-in-polygon-spatial-joins" class="nav-link" data-scroll-target="#point-in-polygon-spatial-joins">7.2.1 Point-in-polygon spatial joins</a></li>
  <li><a href="#spatial-joins-and-group-wise-spatial-analysis" id="toc-spatial-joins-and-group-wise-spatial-analysis" class="nav-link" data-scroll-target="#spatial-joins-and-group-wise-spatial-analysis">7.2.2 Spatial joins and group-wise spatial analysis</a></li>
  </ul></li>
  <li><a href="#small-area-time-series-analysis" id="toc-small-area-time-series-analysis" class="nav-link" data-scroll-target="#small-area-time-series-analysis">7.3 Small area time-series analysis</a>
  <ul class="collapse">
  <li><a href="#area-weighted-areal-interpolation" id="toc-area-weighted-areal-interpolation" class="nav-link" data-scroll-target="#area-weighted-areal-interpolation">Area-weighted areal interpolation</a></li>
  <li><a href="#population-weighted-areal-interpolation" id="toc-population-weighted-areal-interpolation" class="nav-link" data-scroll-target="#population-weighted-areal-interpolation">7.3.2 Population-weighted areal interpolation</a></li>
  <li><a href="#making-small-area-comparisons" id="toc-making-small-area-comparisons" class="nav-link" data-scroll-target="#making-small-area-comparisons">7.3.3 Making small-area comparisons</a></li>
  </ul></li>
  <li><a href="#distance-and-proximity-analysis" id="toc-distance-and-proximity-analysis" class="nav-link" data-scroll-target="#distance-and-proximity-analysis">7.4 Distance and proximity analysis</a>
  <ul class="collapse">
  <li><a href="#calculating-distances" id="toc-calculating-distances" class="nav-link" data-scroll-target="#calculating-distances">7.4.1 Calculating distances</a></li>
  <li><a href="#calculating-travel-times" id="toc-calculating-travel-times" class="nav-link" data-scroll-target="#calculating-travel-times">7.4.2 Calculating travel times</a></li>
  <li><a href="#catchment-areas-with-buffers-and-isochrones" id="toc-catchment-areas-with-buffers-and-isochrones" class="nav-link" data-scroll-target="#catchment-areas-with-buffers-and-isochrones">Catchment areas with buffers and isochrones</a></li>
  <li><a href="#computing-demographic-estimates-for-zones-with-areal-interpolation" id="toc-computing-demographic-estimates-for-zones-with-areal-interpolation" class="nav-link" data-scroll-target="#computing-demographic-estimates-for-zones-with-areal-interpolation">7.4.4 Computing demographic estimates for zones with areal interpolation</a></li>
  </ul></li>
  <li><a href="#better-cartography-with-spatial-overlay" id="toc-better-cartography-with-spatial-overlay" class="nav-link" data-scroll-target="#better-cartography-with-spatial-overlay">7.5 Better cartography with spatial overlay</a>
  <ul class="collapse">
  <li><a href="#erasing-areas-from-census-polygons" id="toc-erasing-areas-from-census-polygons" class="nav-link" data-scroll-target="#erasing-areas-from-census-polygons">7.5.1 “Erasing” areas from Census polygons</a></li>
  </ul></li>
  <li><a href="#spatial-neighborhoods-and-spatial-weights-matrices" id="toc-spatial-neighborhoods-and-spatial-weights-matrices" class="nav-link" data-scroll-target="#spatial-neighborhoods-and-spatial-weights-matrices">7.6 Spatial neighborhoods and spatial weights matrices</a>
  <ul class="collapse">
  <li><a href="#understanding-spatial-neighborhoods" id="toc-understanding-spatial-neighborhoods" class="nav-link" data-scroll-target="#understanding-spatial-neighborhoods">7.6.1 Understanding spatial neighborhoods</a></li>
  <li><a href="#generating-the-spatial-weights-matrix" id="toc-generating-the-spatial-weights-matrix" class="nav-link" data-scroll-target="#generating-the-spatial-weights-matrix">7.6.2 Generating the spatial weights matrix</a></li>
  </ul></li>
  <li><a href="#global-and-local-spatial-autocorrelation" id="toc-global-and-local-spatial-autocorrelation" class="nav-link" data-scroll-target="#global-and-local-spatial-autocorrelation">7.7 Global and local spatial autocorrelation</a>
  <ul class="collapse">
  <li><a href="#spatial-lags-and-morans-i" id="toc-spatial-lags-and-morans-i" class="nav-link" data-scroll-target="#spatial-lags-and-morans-i">7.7.1 Spatial lags and Moran’s I</a></li>
  <li><a href="#local-spatial-autocorrelation" id="toc-local-spatial-autocorrelation" class="nav-link" data-scroll-target="#local-spatial-autocorrelation">7.7.2 Local spatial autocorrelation</a></li>
  <li><a href="#identifying-clusters-and-spatial-outliers-with-local-indicators-of-spatial-association-lisa" id="toc-identifying-clusters-and-spatial-outliers-with-local-indicators-of-spatial-association-lisa" class="nav-link" data-scroll-target="#identifying-clusters-and-spatial-outliers-with-local-indicators-of-spatial-association-lisa">7.7.3 Identifying clusters and spatial outliers with local indicators of spatial association (LISA)</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://github.com/deandevl/RcensusPkg"><i class="bi bi-link-45deg"></i>RcensusPkg</a></li><li><a href="https://github.com/deandevl/RspatialPkg"><i class="bi bi-link-45deg"></i>RspatialPkg</a></li><li><a href="https://github.com/deandevl/RplotterPkg"><i class="bi bi-link-45deg"></i>RplotterPkg</a></li><li><a href="https://cran.r-project.org/web/packages/data.table/index.html"><i class="bi bi-link-45deg"></i>data.table</a></li><li><a href="https://github.com/deandevl"><i class="bi bi-link-45deg"></i>deandevl</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://github.com/deandevl/Techniques-in-Acquisition-Computation-and-Display-of-Census-Bureau-Data"><i class="bi bi-github"></i>source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 15, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="spatial-analysis-with-us-census-data" class="level1 page-columns page-full">
<h1>7 Spatial analysis with US Census data</h1>
<div class="task">
<p>Load the Required R Packages from CRAN:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(usmap)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Load the packages ‘deandevl/RcensusPkg’, ‘deandevl/RplotterPkg’ and ‘deandevl/RspatialPkg’.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'deandevl/RcensusPkg'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'deandevl/RspatialPkg'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">'deandevl/RplotterPkg'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Establish an output directory for all downloaded shapefiles.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>output_dir <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">"shapefiles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="spatial-overlay" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spatial-overlay">7.1 Spatial overlay</h2>
<blockquote class="blockquote">
<p>In this representation, different components of the landscape that interact in the real world are abstracted out into different layers, represented by different geometries. For example, Census tracts might be represented as polygons; customers as points; and roads as linestrings.</p>
</blockquote>
<section id="note-aligning-coordinate-reference-systems" class="level3">
<h3 class="anchored" data-anchor-id="note-aligning-coordinate-reference-systems">7.1.1 Note: aligning coordinate reference systems</h3>
<blockquote class="blockquote">
<p>In any workflow using spatial overlay, including all of the methods discussed in this chapter, it is essential that all layers share the same CRS for overlay methods to work.</p>
</blockquote>
<p>Use the <code>sf::st_transform()</code> to transform data toe the projected CRS.</p>
</section>
<section id="identifying-geometries-within-a-metropolitan-area" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="identifying-geometries-within-a-metropolitan-area">7.1.2 Identifying geometries within a metropolitan area</h3>
<blockquote class="blockquote">
<p>Given that Census spatial datasets are designed to align with one another, spatial overlay can be used to identify geographic features that fall within a given metropolitan area and extract those features.</p>
</blockquote>
<div class="task">
<p>Overlay the boundary geometries of the Kansas City metropolitan area with the state tract boundaries of Kansas and Missouri.</p>
</div>
<p>Get the fips numbers for the states of Kansas and Missouri:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ks_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"kansas"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mo_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"missouri"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the combined tracts of both states:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ks_mo_tracts_sf <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dfr</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(ks_fips, mo_fips), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>{RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> .x, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">general =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">transform_crs =</span> <span class="dv">8528</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">output_dir =</span> output_dir, </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the metropolitan area (core-based statistical area) of Kansas City:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>kc_metro_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_cbsa_sf</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">city_filter =</span> <span class="st">"Kansas City"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">8528</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Map the overlay of metropolitan area geometries with the Kansas-Missouri tracts geometries:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ks_mo_tracts_sf,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"white"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"gray"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> kc_metro_sf,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_alpha =</span> <span class="fl">0.0</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">adding =</span> <span class="cn">TRUE</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.2: The Kansas City CBSA relative to Kansas and Missouri</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section id="spatial-subsets-and-spatial-predicates" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="spatial-subsets-and-spatial-predicates">7.1.3 Spatial subsets and spatial predicates</h3>
<div class="task">
<p>Subset and map <code>ks_mo_tracts_sf</code> tract geometries to just the CBSA Kansas City geometries <code>kc_metro_sf</code>.</p>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Note that <code>[]</code> operator is using the default spatial function <code>sf::st_intersect()</code> to accomplish the intersection. It returns tracts that are within the metro’s boundary and those that cross or touch the boundary.</span></div></div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>kc_tracts_sf <span class="ot">&lt;-</span> ks_mo_tracts_sf[kc_metro_sf,]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> kc_tracts_sf,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"white"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"grey"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> kc_metro_sf,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_alpha =</span> <span class="fl">0.0</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">adding =</span> <span class="cn">TRUE</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.3: Census tracts that intersect the Kansas City CBSA</figcaption>
</figure>
</div>
</div></div></div>
<div class="task">
<p>Use the spatial predicate <code>sf::st_within()</code> to return tracts only within the Kansas City CBSA geometries.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>kc_tracts_within_sf <span class="ot">&lt;-</span> kc_tracts_sf[kc_metro_sf, op <span class="ot">=</span> sf<span class="sc">::</span>st_within]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> kc_tracts_within_sf,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"white"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"grey"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> kc_metro_sf,</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_alpha =</span> <span class="fl">0.0</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">adding =</span> <span class="cn">TRUE</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.4: Census tracts that are within the Kansas City CBSA</figcaption>
</figure>
</div>
</div></div></div>
</section>
</section>
<section id="spatial-joins" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spatial-joins">7.2 Spatial joins</h2>
<section id="point-in-polygon-spatial-joins" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="point-in-polygon-spatial-joins">7.2.1 Point-in-polygon spatial joins</h3>
<blockquote class="blockquote">
<p>Let’s consider a hypothetical task where a health data analyst in Gainesville, Florida needs to determine the percentage of residents age 65 and up who lack health insurance in patients’ neighborhoods. The analyst has a dataset of patients with patient ID along with longitude and latitude information.</p>
</blockquote>
<p>Create a hypothetical dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>gainesville_patients_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">patient_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">longitude =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">82.308131</span>, <span class="sc">-</span><span class="fl">82.311972</span>, <span class="sc">-</span><span class="fl">82.361748</span>, <span class="sc">-</span><span class="fl">82.374377</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span><span class="fl">82.38177</span>, <span class="sc">-</span><span class="fl">82.259461</span>, <span class="sc">-</span><span class="fl">82.367436</span>, <span class="sc">-</span><span class="fl">82.404031</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="sc">-</span><span class="fl">82.43289</span>, <span class="sc">-</span><span class="fl">82.461844</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">latitude =</span> <span class="fu">c</span>(<span class="fl">29.645933</span>, <span class="fl">29.655195</span>, <span class="fl">29.621759</span>, <span class="fl">29.653576</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>               <span class="fl">29.677201</span>, <span class="fl">29.674923</span>, <span class="fl">29.71099</span>, <span class="fl">29.711587</span>, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>               <span class="fl">29.648227</span>, <span class="fl">29.624037</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.1: Hypothetical dataset of patients in Gainesville, Florida</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">patient_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">longitude</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">latitude</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-82.30813</td>
<td style="text-align: right;">29.64593</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-82.31197</td>
<td style="text-align: right;">29.65519</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">-82.36175</td>
<td style="text-align: right;">29.62176</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">-82.37438</td>
<td style="text-align: right;">29.65358</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">-82.38177</td>
<td style="text-align: right;">29.67720</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">-82.25946</td>
<td style="text-align: right;">29.67492</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<p>Using <code>sf::st_as_sf()</code> convert the dataframe to a simple features object with a geometry column:</p>
<blockquote class="blockquote">
<p>By convention, the coordinate reference system used for longitude / latitude data is WGS 1984, represented with the EPSG code 4326. We’ll need to specify this CRS in st_as_sf() so that sf can locate the points correctly before we transform to an appropriate projected coordinate reference system with st_transform().</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>gainesville_sf <span class="ot">&lt;-</span> gainesville_patients_dt <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>,<span class="st">"latitude"</span>), <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">6440</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Map the sf with <code>mapview()</code>:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> gainesville_sf,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.regions =</span> <span class="st">"red"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> F</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-295f5d5e7a2ac5f09f92" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-295f5d5e7a2ac5f09f92">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[29.64593300000001,29.655195,29.62175899999999,29.653576,29.677201,29.67492299999997,29.71098999999999,29.711587,29.648227,29.62403699999999],[-82.308131,-82.311972,-82.36174800000001,-82.374377,-82.38177,-82.259461,-82.36743600000001,-82.404031,-82.43289,-82.461844],6,null,"gainesville_sf",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":"#FF0000","fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 1&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 2&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 3&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 4&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 5&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 6&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 7&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 8&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 9&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td>10&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-82.461844,29.62175899999999,-82.259461,29.711587,true,"gainesville_sf","Zoom to gainesville_sf","<strong> gainesville_sf <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"gainesville_sf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[29.62175899999999,29.711587],"lng":[-82.461844,-82.259461]},"fitBounds":[29.62175899999999,-82.461844,29.711587,-82.259461,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<p>Figure 7.5: Map of hypothetical patient locations in Gainsville, Florida</p>
</div></div></div>
<p>Acquire health insurance percent (“DP03_0096PE”,“DP03_0096PM”) coverage by tract from the American Community Survey (“acs/acs5/profile”). Gainsville is within Alachua County, Florida with data available from the 2015-2019 5-year ACS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fl_alachua_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"florida"</span>, <span class="at">county =</span> <span class="st">"alachua"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fl_fips <span class="ot">&lt;-</span> <span class="fu">substr</span>(fl_alachua_fips,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>alachua_fips <span class="ot">&lt;-</span> <span class="fu">substr</span>(fl_alachua_fips,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>alachua_insurance_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5/profile"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"DP03_0096PE"</span>, <span class="st">"DP03_0096PM"</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, fl_fips, <span class="st">"+county:"</span>, alachua_fips)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(., <span class="at">old =</span> <span class="fu">c</span>(<span class="st">"DP03_0096PE"</span>, <span class="st">"DP03_0096PM"</span>),<span class="at">new =</span> <span class="fu">c</span>(<span class="st">"pct_insured"</span>,<span class="st">"pct_insured_moe"</span>)) <span class="sc">%&gt;%</span>   .[, .(GEOID, pct_insured, pct_insured_moe)] <span class="sc">%&gt;%</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">pct_insured =</span> <span class="fu">as.numeric</span>(pct_insured), <span class="at">pct_insured_moe =</span> <span class="fu">as.numeric</span>(pct_insured_moe))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Acquire the tract data for Alachua County and merge the Alachua insurance data based on their cooresponding <strong>GEOID</strong> values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>express <span class="ot">&lt;-</span> <span class="fu">expression</span>(COUNTYFP <span class="sc">==</span> <span class="st">"001"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>alachua_insurance_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> fl_fips,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> express,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> alachua_insurance_dt,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  .[, .(GEOID, pct_insured, pct_insured_moe, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">pct_insured =</span> <span class="fu">as.numeric</span>(pct_insured), <span class="at">pct_insured_moe =</span> <span class="fu">as.numeric</span>(pct_insured_moe))] <span class="sc">%&gt;%</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(., <span class="dv">6440</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Before computing the spatial join, layer the point data over the Gainsville, Florida tracts using <strong>mapview</strong>.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  alachua_insurance_sf,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">zcol =</span> <span class="st">"pct_insured"</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer.name =</span> <span class="st">"% with health&lt;br/&gt;insurance"</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    gainesville_sf,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.regions =</span> <span class="st">"red"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="cn">FALSE</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-152325f2c9380e32d102" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-152325f2c9380e32d102">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-82.339354,-82.33937499999999,-82.33937299999999,-82.33928,-82.33926,-82.339208,-82.337143,-82.33295000000001,-82.32829699999999,-82.32659099999999,-82.326618,-82.32659199999999,-82.33082,-82.330837,-82.326582,-82.326534,-82.33365499999999,-82.33782099999999,-82.339384,-82.339354],"lat":[29.64489700000001,29.648466,29.65205600000001,29.65391700000001,29.65572299999999,29.659186,29.65939599999998,29.65942600000001,29.65944,29.65923699999999,29.65896399999999,29.653325,29.65338200000001,29.65027399999999,29.65028500000001,29.64421899999999,29.64299400000002,29.642023,29.64097600000001,29.64489700000001]}]],[[{"lng":[-82.33921599999999,-82.339192,-82.33080099999999,-82.321558,-82.32412699999999,-82.324529,-82.32308599999999,-82.32310900000002,-82.32659099999999,-82.32829699999999,-82.33295000000001,-82.337143,-82.339208,-82.33921599999999],"lat":[29.66667799999998,29.67396799999998,29.673934,29.673888,29.669195,29.666642,29.66660400000001,29.65923099999999,29.65923699999999,29.65944,29.65942600000001,29.65939599999998,29.659186,29.66667799999998]}]],[[{"lng":[-82.339164,-82.339091,-82.338972,-82.338875,-82.32590499999999,-82.319368,-82.31936899999999,-82.319818,-82.321558,-82.33080099999999,-82.339192,-82.339164],"lat":[29.679131,29.68854399999998,29.69898199999998,29.69963599999999,29.68846,29.68841699999999,29.67908699999998,29.6771,29.673888,29.673934,29.67396799999998,29.679131]}]],[[{"lng":[-82.32412699999999,-82.321558,-82.319818,-82.31936899999999,-82.319368,-82.305789,-82.29993899999999,-82.295816,-82.28928399999999,-82.29686799999999,-82.30183,-82.310256,-82.32308599999999,-82.324529,-82.32412699999999],"lat":[29.669195,29.673888,29.6771,29.67908699999998,29.68841699999999,29.688349,29.68831699999998,29.68775900000002,29.68502500000001,29.673817,29.666511,29.66654600000001,29.66660400000001,29.666642,29.669195]}]],[[{"lng":[-82.33082,-82.32659199999999,-82.326618,-82.32659099999999,-82.32310900000002,-82.32308599999999,-82.310256,-82.30183,-82.30657599999999,-82.311469,-82.31150500000001,-82.315105,-82.317746,-82.31846899999999,-82.32503299999999,-82.326534,-82.326582,-82.330837,-82.33082],"lat":[29.65338200000001,29.653325,29.65896399999999,29.65923699999999,29.65923099999999,29.66660400000001,29.66654600000001,29.666511,29.65933799999998,29.65198500000001,29.65174099999999,29.64702599999999,29.64579800000001,29.64558600000003,29.64447400000001,29.64421899999999,29.65028500000001,29.65027399999999,29.65338200000001]}]],[[{"lng":[-82.311469,-82.30657599999999,-82.30183,-82.301436,-82.30222499999999,-82.28914700000001,-82.288995,-82.288493,-82.285657,-82.27402099999999,-82.27248,-82.27245599999999,-82.272424,-82.27244999999999,-82.272465,-82.27246799999999,-82.27248999999999,-82.28497299999999,-82.289187,-82.30530299999999,-82.30583899999999,-82.30721699999999,-82.31150500000001,-82.311469],"lat":[29.65198500000001,29.65933799999998,29.666511,29.66655,29.665245,29.66534200000001,29.663594,29.663137,29.662795,29.66276000000002,29.66275599999998,29.65556799999999,29.654912,29.64821300000001,29.64573200000002,29.64447700000001,29.635385,29.64098700000002,29.64290800000002,29.650984,29.65133500000002,29.65201699999999,29.65174099999999,29.65198500000001]}]],[[{"lng":[-82.326289,-82.32503299999999,-82.31846899999999,-82.317746,-82.315105,-82.31150500000001,-82.30721699999999,-82.30583899999999,-82.30530299999999,-82.289187,-82.28497299999999,-82.27248999999999,-82.268811,-82.26682799999999,-82.259371,-82.25666199999999,-82.25599199999999,-82.25571699999999,-82.255201,-82.25366400000001,-82.251986,-82.2483,-82.248103,-82.253957,-82.263114,-82.27194600000001,-82.27337500000002,-82.28230599999999,-82.284077,-82.292648,-82.295284,-82.295917,-82.298141,-82.300635,-82.304558,-82.305239,-82.30754899999999,-82.30800499999999,-82.30862599999999,-82.30873699999999,-82.311167,-82.31807599999999,-82.31807999999999,-82.322322,-82.32530799999999,-82.32755,-82.326289],"lat":[29.639135,29.64447400000001,29.64558600000003,29.64579800000001,29.64702599999999,29.65174099999999,29.65201699999999,29.65133500000002,29.650984,29.64290800000002,29.64098700000002,29.635385,29.63365700000001,29.63241099999999,29.62614499999998,29.621858,29.619691,29.616125,29.61455199999999,29.61273299999999,29.612025,29.61117200000001,29.61076900000002,29.61206799999999,29.61329300000002,29.607762,29.603528,29.59644900000001,29.59583599999998,29.598476,29.60174599999998,29.60571499999998,29.607448,29.60743299999999,29.60872499999999,29.609356,29.613464,29.61534600000001,29.617346,29.61909399999999,29.62765499999999,29.627739,29.629879,29.62952199999999,29.631233,29.63571099999999,29.639135]}]],[[{"lng":[-82.339384,-82.33782099999999,-82.33365499999999,-82.326534,-82.32503299999999,-82.326289,-82.32755,-82.32812199999999,-82.334648,-82.33938999999999,-82.339384],"lat":[29.64097600000001,29.642023,29.64299400000002,29.64421899999999,29.64447400000001,29.639135,29.63571099999999,29.63602299999999,29.63664700000001,29.636508,29.64097600000001]}]],[[{"lng":[-82.340013,-82.339879,-82.339405,-82.33943499999999,-82.33938999999999,-82.334648,-82.32812199999999,-82.32755,-82.32530799999999,-82.322322,-82.326803,-82.327388,-82.327989,-82.32859499999999,-82.32987,-82.33366199999999,-82.33460599999999,-82.335588,-82.33666599999999,-82.3374,-82.339524,-82.339868,-82.34085499999999,-82.340013],"lat":[29.62053299999999,29.621431,29.62424599999999,29.62849899999999,29.636508,29.63664700000001,29.63602299999999,29.63571099999999,29.631233,29.62952199999999,29.62205300000002,29.621426,29.620898,29.62045999999999,29.61970100000001,29.61753500000001,29.61698600000002,29.61645500000001,29.61614799999999,29.615839,29.61498700000001,29.61492,29.61484999999999,29.62053299999999]}]],[[{"lng":[-82.355859,-82.341728,-82.339384,-82.33938999999999,-82.33943499999999,-82.339405,-82.339879,-82.34077099999999,-82.34402299999999,-82.34540899999999,-82.345428,-82.34707200000001,-82.34841900000001,-82.350641,-82.35129599999999,-82.35418799999999,-82.35586300000001,-82.355859],"lat":[29.63441200000001,29.63949400000001,29.64097600000001,29.636508,29.62849899999999,29.62424599999999,29.621431,29.621293,29.62137799999999,29.621966,29.62258199999999,29.62398999999998,29.62324199999999,29.62362599999999,29.62486899999998,29.626537,29.62651700000001,29.63441200000001]}]],[[{"lng":[-82.37252199999999,-82.372423,-82.36416299999999,-82.364299,-82.36263199999999,-82.36261399999999,-82.361282,-82.361525,-82.355717,-82.3557,-82.355413,-82.35040099999999,-82.35048499999999,-82.35185899999999,-82.35374200000001,-82.358198,-82.35886499999999,-82.37259899999999,-82.37252199999999],"lat":[29.64503599999997,29.650321,29.65039700000001,29.64506199999999,29.64495999999997,29.647792,29.647772,29.650376,29.65039200000001,29.64849399999999,29.644914,29.64489099999997,29.63918400000001,29.63873999999999,29.63843699999999,29.63819699999999,29.637621,29.63765399999998,29.64503599999997]}]],[[{"lng":[-82.35582400000001,-82.353208,-82.35374200000001,-82.35185899999999,-82.35048499999999,-82.35040099999999,-82.355413,-82.3557,-82.355717,-82.35082799999999,-82.34969799999999,-82.34781799999999,-82.34333199999999,-82.33937299999999,-82.33937499999999,-82.339354,-82.339384,-82.341728,-82.355859,-82.35582400000001],"lat":[29.634842,29.63577599999999,29.63843699999999,29.63873999999999,29.63918400000001,29.64489099999997,29.644914,29.64849399999999,29.65039200000001,29.65209300000001,29.652082,29.65207700000001,29.65206400000001,29.65205600000001,29.648466,29.64489700000001,29.64097600000001,29.63949400000001,29.63441200000001,29.634842]}]],[[{"lng":[-82.37245799999999,-82.37238099999999,-82.372406,-82.372373,-82.35577099999999,-82.352908,-82.343244,-82.33921599999999,-82.339208,-82.33926,-82.33928,-82.33937299999999,-82.34333199999999,-82.34781799999999,-82.34969799999999,-82.35082799999999,-82.355717,-82.361525,-82.361282,-82.36261399999999,-82.36263199999999,-82.364299,-82.36416299999999,-82.372423,-82.37245799999999],"lat":[29.65213900000001,29.65354200000001,29.65950700000001,29.66677000000001,29.66674099999999,29.66673700000001,29.666711,29.66667799999998,29.659186,29.65572299999999,29.65391700000001,29.65205600000001,29.65206400000001,29.65207700000001,29.652082,29.65209300000001,29.65039200000001,29.650376,29.647772,29.647792,29.64495999999997,29.64506199999999,29.65039700000001,29.650321,29.65213900000001]}]],[[{"lng":[-82.38897899999999,-82.38896,-82.38896500000001,-82.38893,-82.37232,-82.37232499999999,-82.371798,-82.370429,-82.369654,-82.368944,-82.35363799999999,-82.352019,-82.351152,-82.346231,-82.343221,-82.339192,-82.33921599999999,-82.343244,-82.352908,-82.35577099999999,-82.372373,-82.373171,-82.388981,-82.38897899999999],"lat":[29.67547600000001,29.679565,29.68226799999998,29.68873299999997,29.68869199999999,29.68681900000001,29.68660199999999,29.68249499999998,29.68166100000001,29.68143999999999,29.68127100000001,29.681292,29.68078200000001,29.674448,29.674003,29.67396799999998,29.66667799999998,29.666711,29.66673700000001,29.66674099999999,29.66677000000001,29.66690499999999,29.67408599999998,29.67547600000001]}]],[[{"lng":[-82.388926,-82.388909,-82.38888799999999,-82.37260999999999,-82.363764,-82.36788399999999,-82.369737,-82.371557,-82.37218399999999,-82.37232,-82.38893,-82.388926],"lat":[29.69376099999999,29.69649399999999,29.703259,29.703362,29.70333099999998,29.701505,29.70062299999999,29.698842,29.69718100000002,29.68869199999999,29.68873299999997,29.69376099999999]}]],[[{"lng":[-82.37232,-82.37218399999999,-82.371557,-82.369737,-82.36788399999999,-82.363764,-82.362359,-82.361649,-82.35982199999999,-82.356055,-82.354722,-82.35417799999999,-82.353686,-82.353577,-82.343091,-82.347301,-82.347267,-82.35136799999999,-82.351484,-82.347376,-82.34743499999999,-82.34947699999999,-82.351523,-82.351553,-82.352019,-82.35363799999999,-82.368944,-82.369654,-82.370429,-82.371798,-82.37232499999999,-82.37232],"lat":[29.68869199999999,29.69718100000002,29.698842,29.70062299999999,29.701505,29.70333099999998,29.703949,29.704283,29.70507599999999,29.70695600000002,29.70843900000001,29.70979599999999,29.711902,29.71223400000001,29.703215,29.70327199999998,29.69587699999999,29.695848,29.688519,29.68855299999999,29.68571799999999,29.68578,29.68575999999999,29.68133700000002,29.681292,29.68127100000001,29.68143999999999,29.68166100000001,29.68249499999998,29.68660199999999,29.68681900000001,29.68869199999999]}]],[[{"lng":[-82.351553,-82.351523,-82.34947699999999,-82.34743499999999,-82.347376,-82.351484,-82.35136799999999,-82.347267,-82.347301,-82.343091,-82.338875,-82.338972,-82.339091,-82.339164,-82.339192,-82.343221,-82.346231,-82.351152,-82.352019,-82.351553],"lat":[29.68133700000002,29.68575999999999,29.68578,29.68571799999999,29.68855299999999,29.688519,29.695848,29.69587699999999,29.70327199999998,29.703215,29.69963599999999,29.69898199999998,29.68854399999998,29.679131,29.67396799999998,29.674003,29.674448,29.68078200000001,29.681292,29.68133700000002]}]],[[{"lng":[-82.291313,-82.28649399999999,-82.268733,-82.265867,-82.258194,-82.25794499999999,-82.256147,-82.255336,-82.254454,-82.248053,-82.247494,-82.24292200000001,-82.24105500000002,-82.239226,-82.23807099999999,-82.22484999999999,-82.225064,-82.238247,-82.23850400000001,-82.23597599999999,-82.234673,-82.23700099999999,-82.23765499999999,-82.239378,-82.239501,-82.240792,-82.239525,-82.239234,-82.237664,-82.236791,-82.23782899999999,-82.237161,-82.24280899999999,-82.248549,-82.25062,-82.254178,-82.256339,-82.25673700000002,-82.25765000000001,-82.25651999999999,-82.25496099999999,-82.25262599999999,-82.25155599999999,-82.25184000000002,-82.249189,-82.2483,-82.251986,-82.25366400000001,-82.255201,-82.25571699999999,-82.25599199999999,-82.25666199999999,-82.259371,-82.26682799999999,-82.268811,-82.27248999999999,-82.27246799999999,-82.272465,-82.27244999999999,-82.272424,-82.27245599999999,-82.27248,-82.27402099999999,-82.285657,-82.288493,-82.288995,-82.28914700000001,-82.289154,-82.289125,-82.29141,-82.29104900000002,-82.293869,-82.291313],"lat":[29.67653899999999,29.683442,29.67442400000002,29.67368700000001,29.67360499999999,29.67363099999999,29.67412299999999,29.67457299999999,29.67526299999999,29.681287,29.68181100000001,29.68610099999999,29.68737399999999,29.68786,29.687926,29.687883,29.68743,29.67586100000001,29.67563499999999,29.67353700000001,29.673528,29.670073,29.667015,29.66126000000001,29.65668399999999,29.655462,29.65426900000001,29.65122699999999,29.64723399999999,29.64025899999999,29.63805899999998,29.63633699999998,29.63619200000002,29.633125,29.63143299999999,29.630203,29.628383,29.62584199999998,29.62499499999999,29.624272,29.62106499999999,29.61878599999999,29.61844500000002,29.61774099999999,29.615098,29.61117200000001,29.612025,29.61273299999999,29.61455199999999,29.616125,29.619691,29.621858,29.62614499999998,29.63241099999999,29.63365700000001,29.635385,29.64447700000001,29.64573200000002,29.64821300000001,29.654912,29.65556799999999,29.66275599999998,29.66276000000002,29.662795,29.663137,29.663594,29.66534200000001,29.66645099999999,29.66920200000001,29.67027299999999,29.672477,29.67381600000001,29.67653899999999]}]],[[{"lng":[-82.372625,-82.37259899999999,-82.37259899999999,-82.35886499999999,-82.358198,-82.35374200000001,-82.353208,-82.35582400000001,-82.355859,-82.35586300000001,-82.35677400000002,-82.35722,-82.360851,-82.36095299999999,-82.36112899999999,-82.361183,-82.36148999999999,-82.36169599999999,-82.37099000000001,-82.372601,-82.372625],"lat":[29.63028400000001,29.63422100000001,29.63765399999998,29.637621,29.63819699999999,29.63843699999999,29.63577599999999,29.634842,29.63441200000001,29.62651700000001,29.62638899999999,29.626888,29.62894199999998,29.629057,29.629292,29.62938200000001,29.63019099999999,29.63237900000001,29.628033,29.62693899999998,29.63028400000001]}]],[[{"lng":[-82.372528,-82.372601,-82.37099000000001,-82.36169599999999,-82.36148999999999,-82.361183,-82.36112899999999,-82.36095299999999,-82.360851,-82.35722,-82.35677400000002,-82.35634499999999,-82.35619899999999,-82.35606799999999,-82.35577700000002,-82.359921,-82.362848,-82.364593,-82.365567,-82.36861399999999,-82.371191,-82.37289699999999,-82.372528],"lat":[29.624672,29.62693899999998,29.628033,29.63237900000001,29.63019099999999,29.62938200000001,29.629292,29.629057,29.62894199999998,29.626888,29.62638899999999,29.625605,29.625039,29.62353999999999,29.620275,29.61994299999999,29.61971899999999,29.61967699999999,29.61989799999999,29.62099999999997,29.62173899999999,29.62174599999999,29.624672]}]],[[{"lng":[-82.362848,-82.359921,-82.35577700000002,-82.355058,-82.356562,-82.35909599999999,-82.359758,-82.3622,-82.362848],"lat":[29.61971899999999,29.61994299999999,29.620275,29.61362900000003,29.61319499999999,29.61213499999997,29.613635,29.61341200000001,29.61971899999999]}]],[[{"lng":[-82.37289699999999,-82.371191,-82.36861399999999,-82.365567,-82.364593,-82.362848,-82.3622,-82.359758,-82.35909599999999,-82.360736,-82.365318,-82.371014,-82.37115899999999,-82.37208299999999,-82.37289699999999],"lat":[29.62174599999999,29.62173899999999,29.62099999999997,29.61989799999999,29.61967699999999,29.61971899999999,29.61341200000001,29.613635,29.61213499999997,29.611222,29.60789299999999,29.60378000000001,29.60419599999998,29.61420099999999,29.62174599999999]}]],[[{"lng":[-82.38603599999999,-82.37788599999999,-82.372601,-82.372528,-82.37289699999999,-82.37208299999999,-82.37115899999999,-82.371014,-82.37343299999999,-82.37559299999999,-82.377989,-82.38326499999999,-82.38623600000001,-82.38603599999999],"lat":[29.617413,29.62202000000001,29.62693899999998,29.624672,29.62174599999999,29.61420099999999,29.60419599999998,29.60378000000001,29.602043,29.60446599999999,29.60713399999999,29.61321999999999,29.61729800000001,29.617413]}]],[[{"lng":[-82.39141699999999,-82.385818,-82.38453199999999,-82.38033399999999,-82.374027,-82.375821,-82.37252199999999,-82.37259899999999,-82.37259899999999,-82.380928,-82.384064,-82.38578699999999,-82.38798799999999,-82.392093,-82.39141699999999],"lat":[29.640072,29.64264500000001,29.64277699999998,29.64040099999999,29.64304499999999,29.64505299999999,29.64503599999997,29.63765399999998,29.63422100000001,29.63400000000003,29.63419,29.63458199999996,29.63551700000001,29.638057,29.640072]}]],[[{"lng":[-82.395775,-82.392093,-82.38798799999999,-82.38578699999999,-82.384064,-82.380928,-82.37259899999999,-82.372625,-82.372601,-82.37788599999999,-82.38603599999999,-82.38623600000001,-82.390157,-82.39103999999999,-82.395295,-82.39590100000001,-82.395775],"lat":[29.631244,29.638057,29.63551700000001,29.63458199999996,29.63419,29.63400000000003,29.63422100000001,29.63028400000001,29.62693899999998,29.62202000000001,29.617413,29.61729800000001,29.62286999999999,29.624122,29.63015499999998,29.63101299999997,29.631244]}]],[[{"lng":[-82.399203,-82.389156,-82.372406,-82.37238099999999,-82.37245799999999,-82.378236,-82.379688,-82.392566,-82.39888800000001,-82.40155799999999,-82.399203],"lat":[29.659593,29.65957799999999,29.65950700000001,29.65354200000001,29.65213900000001,29.651924,29.652027,29.65669099999998,29.658921,29.65947099999999,29.659593]}]],[[{"lng":[-82.41912599999999,-82.40887599999999,-82.40815599999999,-82.403066,-82.40155799999999,-82.39888800000001,-82.392566,-82.379688,-82.378236,-82.37245799999999,-82.372423,-82.37252199999999,-82.375821,-82.374027,-82.38033399999999,-82.38453199999999,-82.385818,-82.39141699999999,-82.392093,-82.395775,-82.39590100000001,-82.402349,-82.40850499999999,-82.41900099999999,-82.41912599999999],"lat":[29.65969399999998,29.659653,29.65965999999998,29.659617,29.65947099999999,29.658921,29.65669099999998,29.652027,29.651924,29.65213900000001,29.650321,29.64503599999997,29.64505299999999,29.64304499999999,29.64040099999999,29.64277699999998,29.64264500000001,29.640072,29.638057,29.631244,29.63101299999997,29.639912,29.64717499999999,29.65954799999999,29.65969399999998]}]],[[{"lng":[-82.44681799999999,-82.43056899999999,-82.40977699999999,-82.40042,-82.397386,-82.39231599999999,-82.38904699999999,-82.38893,-82.38896500000001,-82.38896,-82.38897899999999,-82.388981,-82.401495,-82.403927,-82.418615,-82.424289,-82.432548,-82.44681799999999],"lat":[29.68902599999999,29.68891099999999,29.688833,29.68877999999999,29.68873299999997,29.688728,29.688724,29.68873299999997,29.68226799999998,29.679565,29.67547600000001,29.67408599999998,29.674105,29.674104,29.67424799999999,29.67408500000001,29.674307,29.68902599999999]}]],[[{"lng":[-82.424289,-82.418615,-82.403927,-82.401495,-82.388981,-82.373171,-82.372373,-82.372406,-82.389156,-82.399203,-82.40155799999999,-82.403066,-82.40815599999999,-82.40887599999999,-82.41912599999999,-82.41937399999999,-82.42339,-82.432548,-82.424289],"lat":[29.67408500000001,29.67424799999999,29.674104,29.674105,29.67408599999998,29.66690499999999,29.66677000000001,29.65950700000001,29.65957799999999,29.659593,29.65947099999999,29.659617,29.65965999999998,29.659653,29.65969399999998,29.65998599999998,29.664706,29.674307,29.67408500000001]}]],[[{"lng":[-82.63125099999999,-82.629262,-82.62203699999999,-82.61849699999999,-82.617813,-82.617514,-82.61847,-82.622394,-82.62292699999999,-82.619739,-82.616452,-82.615882,-82.61386999999999,-82.611351,-82.60992399999999,-82.60846599999999,-82.60627599999999,-82.60367599999999,-82.60242199999999,-82.60055199999999,-82.599863,-82.597171,-82.595449,-82.59437899999999,-82.59289699999999,-82.59123099999999,-82.588376,-82.586485,-82.586792,-82.589558,-82.59022499999999,-82.59233999999999,-82.592553,-82.57999699999999,-82.58002900000001,-82.57587599999999,-82.57596599999999,-82.579526,-82.57878599999999,-82.578266,-82.571552,-82.570621,-82.56785600000001,-82.56628599999999,-82.56658299999999,-82.564739,-82.56325,-82.560934,-82.56205199999999,-82.56083699999999,-82.558649,-82.55473499999999,-82.551334,-82.54813399999999,-82.54523499999999,-82.54155399999999,-82.53957199999999,-82.535067,-82.53177699999999,-82.53045299999999,-82.529439,-82.529269,-82.53026199999999,-82.52970499999999,-82.52794899999999,-82.52651600000002,-82.526572,-82.525368,-82.524103,-82.52217999999999,-82.522148,-82.52014,-82.51643199999999,-82.510972,-82.50479799999999,-82.503157,-82.50156,-82.501105,-82.49924799999999,-82.49898999999999,-82.49608099999999,-82.49544499999999,-82.49204499999999,-82.491412,-82.490726,-82.486221,-82.485636,-82.484532,-82.48384700000001,-82.48431800000002,-82.48204199999999,-82.481167,-82.47966099999999,-82.477572,-82.47671,-82.47725299999999,-82.47567599999999,-82.47543999999999,-82.472129,-82.469989,-82.46912999999999,-82.46914099999999,-82.468379,-82.46493199999999,-82.46337299999999,-82.46128399999999,-82.460127,-82.45878599999999,-82.458325,-82.45667899999999,-82.45306099999999,-82.45121499999999,-82.45037099999999,-82.448948,-82.446597,-82.444165,-82.44171299999999,-82.439774,-82.43943800000001,-82.437583,-82.436587,-82.43610799999999,-82.435531,-82.435115,-82.433807,-82.434186,-82.43374299999999,-82.433362,-82.42927,-82.42667,-82.42629199999999,-82.42394399999999,-82.422399,-82.42045499999999,-82.41872800000002,-82.41641299999999,-82.41638600000002,-82.41573199999999,-82.412983,-82.413257,-82.41104299999999,-82.410304,-82.41114,-82.408996,-82.40965799999999,-82.406629,-82.405503,-82.407022,-82.405862,-82.40648499999999,-82.40446799999999,-82.406003,-82.405781,-82.40395699999999,-82.40465500000001,-82.40357299999999,-82.404456,-82.402856,-82.40235899999999,-82.40128399999999,-82.400926,-82.39867,-82.398771,-82.39719699999999,-82.39764699999999,-82.39439,-82.391695,-82.389584,-82.38877099999999,-82.38861399999999,-82.38741499999999,-82.38268400000001,-82.378646,-82.37897,-82.37719799999999,-82.37500299999999,-82.37389300000001,-82.374528,-82.37834099999999,-82.379783,-82.377279,-82.376257,-82.378052,-82.37743999999999,-82.377763,-82.376508,-82.37477,-82.374377,-82.374318,-82.375861,-82.376571,-82.377107,-82.37850399999999,-82.378379,-82.37668599999999,-82.38031699999999,-82.383078,-82.388701,-82.39191099999999,-82.400795,-82.405103,-82.40517199999999,-82.409086,-82.411687,-82.42477799999999,-82.42718499999999,-82.443715,-82.449389,-82.457601,-82.462143,-82.46790399999999,-82.46935599999999,-82.47225399999999,-82.475015,-82.478092,-82.479788,-82.48777699999999,-82.48966799999999,-82.49190299999999,-82.49356399999999,-82.494198,-82.494259,-82.50367399999999,-82.51403499999999,-82.52655799999999,-82.53297999999999,-82.53542899999999,-82.543915,-82.55435899999999,-82.557514,-82.559978,-82.561801,-82.56236299999999,-82.562719,-82.57998099999999,-82.588357,-82.590698,-82.619781,-82.62175000000001,-82.624903,-82.626671,-82.630646,-82.630571,-82.632104,-82.63125099999999],"lat":[29.84911199999999,29.849373,29.84851199999999,29.84700199999999,29.84726,29.84948499999998,29.85089099999999,29.85209399999999,29.85400500000002,29.85911099999998,29.85778600000001,29.85658399999998,29.85434800000002,29.85229199999998,29.852147,29.85292699999999,29.852864,29.85473599999999,29.857656,29.85827200000001,29.85897799999999,29.85889700000003,29.85970800000001,29.86122,29.861933,29.866042,29.86686000000001,29.866702,29.86766799999998,29.87045200000001,29.87320399999999,29.87322100000001,29.88751499999998,29.88764000000002,29.89485099999999,29.89486500000001,29.91309500000002,29.91444399999999,29.915362,29.91584499999999,29.91827599999997,29.917533,29.917196,29.91933499999999,29.92056599999999,29.920227,29.921427,29.92215400000001,29.92266500000001,29.924916,29.92663700000001,29.92854100000001,29.92871200000001,29.925571,29.925099,29.92549499999998,29.92886799999999,29.92928299999998,29.93105800000002,29.93237800000001,29.93427700000001,29.936761,29.939138,29.94088100000002,29.94121600000001,29.942417,29.94330799999998,29.94495999999999,29.94525399999999,29.94462099999998,29.94353799999999,29.943937,29.943363,29.94520699999999,29.94283499999998,29.94182500000001,29.94201500000002,29.94113799999998,29.94019399999999,29.93888100000001,29.93951399999999,29.94011399999999,29.939245,29.93826700000001,29.93902099999998,29.93987199999999,29.939094,29.93973,29.938461,29.93687799999999,29.93590399999999,29.937014,29.935815,29.93489300000001,29.93300300000002,29.93212000000001,29.932384,29.93043199999999,29.92654699999999,29.92579399999999,29.92713399999999,29.92842599999999,29.928265,29.92958800000001,29.92863600000001,29.93162099999999,29.930372,29.930518,29.92916900000001,29.927568,29.92567500000003,29.92667,29.92897599999998,29.93151499999999,29.931818,29.93096199999999,29.92911200000003,29.92933900000001,29.93098299999999,29.93033100000001,29.93085,29.93031200000001,29.928616,29.92836399999999,29.92832700000003,29.92927599999998,29.92954799999996,29.92926499999998,29.92553500000001,29.92209600000001,29.92180699999998,29.92067699999999,29.919923,29.92084599999999,29.92309299999999,29.92232499999999,29.92165300000001,29.922486,29.922238,29.92122000000001,29.920582,29.91805199999999,29.91723799999999,29.91691200000001,29.91503100000001,29.914054,29.911204,29.91017799999998,29.90889299999998,29.90737900000003,29.90477999999998,29.90407099999999,29.90251499999999,29.89960099999999,29.89840899999999,29.89765200000001,29.89574999999999,29.89578699999999,29.89371099999999,29.89282499999998,29.89002600000002,29.889391,29.88731899999999,29.88753,29.88615599999998,29.88659000000001,29.88409999999998,29.884594,29.88413099999999,29.88179799999999,29.88190300000002,29.88092199999998,29.882526,29.880942,29.881387,29.87943299999998,29.879292,29.87705700000001,29.87452500000001,29.869806,29.86754999999999,29.86575099999999,29.86203399999998,29.86095,29.85962400000001,29.857743,29.85654599999999,29.853967,29.85031999999997,29.84712799999998,29.845977,29.84448799999999,29.842656,29.841017,29.839945,29.839908,29.84001,29.843371,29.84441300000001,29.84440700000001,29.84332700000001,29.83925999999998,29.83663300000001,29.834763,29.827347,29.82633699999999,29.82009899999998,29.818233,29.81509900000001,29.81403999999998,29.81191899999999,29.81116399999999,29.80773199999999,29.80454299999999,29.803852,29.803824,29.80375299999999,29.80373899999998,29.80345599999999,29.802312,29.80120600000001,29.79378200000001,29.79957000000002,29.80182299999999,29.804382,29.805687,29.806176,29.80790600000001,29.81002499999998,29.810675,29.811207,29.81176600000001,29.81197599999998,29.81213100000001,29.81972200000001,29.82345499999999,29.82425,29.83703800000001,29.83790799999998,29.83930099999999,29.84020999999998,29.842782,29.842908,29.84680699999999,29.84911199999999]}]],[[{"lng":[-82.494198,-82.49356399999999,-82.49190299999999,-82.48966799999999,-82.48777699999999,-82.479788,-82.478092,-82.475015,-82.47225399999999,-82.46935599999999,-82.46790399999999,-82.462143,-82.457601,-82.449389,-82.443715,-82.42718499999999,-82.42477799999999,-82.411687,-82.409086,-82.40517199999999,-82.405103,-82.400795,-82.39191099999999,-82.388701,-82.383078,-82.38031699999999,-82.37668599999999,-82.376791,-82.375328,-82.375084,-82.375327,-82.371409,-82.371332,-82.37219399999999,-82.372389,-82.370504,-82.367998,-82.36734799999999,-82.36891,-82.369456,-82.37064099999999,-82.371583,-82.371065,-82.371095,-82.384755,-82.383759,-82.38112,-82.37831199999999,-82.37238499999999,-82.37116,-82.37069,-82.36961599999999,-82.35755800000001,-82.357283,-82.356883,-82.35616800000001,-82.355223,-82.35460599999999,-82.354094,-82.353779,-82.35409299999999,-82.35349699999999,-82.353577,-82.353686,-82.36032800000001,-82.377481,-82.381091,-82.38400999999999,-82.38575500000002,-82.38793099999999,-82.388352,-82.38888100000001,-82.40203699999999,-82.403673,-82.404595,-82.405681,-82.40778899999999,-82.40773299999999,-82.408062,-82.408795,-82.40984999999999,-82.41049699999999,-82.413265,-82.41902,-82.42134999999999,-82.422507,-82.423945,-82.42830300000001,-82.43348,-82.44928299999999,-82.454792,-82.46391,-82.471497,-82.47376799999999,-82.47739299999999,-82.479759,-82.48100199999999,-82.48257599999999,-82.48525599999999,-82.49106599999999,-82.494259,-82.494198],"lat":[29.80120600000001,29.802312,29.80345599999999,29.80373899999998,29.80375299999999,29.803824,29.803852,29.80454299999999,29.80773199999999,29.81116399999999,29.81191899999999,29.81403999999998,29.81509900000001,29.818233,29.82009899999998,29.82633699999999,29.827347,29.834763,29.83663300000001,29.83925999999998,29.84332700000001,29.84440700000001,29.84441300000001,29.843371,29.84001,29.839908,29.839945,29.83638500000001,29.83496500000001,29.83196699999998,29.826902,29.81923299999999,29.81695099999999,29.81528600000001,29.813591,29.81163199999999,29.811078,29.80974199999999,29.80872399999999,29.80728,29.80666400000002,29.804322,29.80322199999999,29.80091700000001,29.80059499999999,29.79714899999998,29.79201899999999,29.787015,29.777693,29.77571300000001,29.77503799999999,29.77332600000001,29.75778499999999,29.757248,29.756272,29.75283499999999,29.74799599999999,29.74493100000001,29.74222,29.74016499999999,29.72176600000002,29.71443499999999,29.71223400000001,29.711902,29.71748999999998,29.73223399999999,29.736136,29.73934499999999,29.74131199999999,29.74370700000001,29.74418900000001,29.74482599999999,29.75933299999999,29.76075999999998,29.76170299999998,29.762628,29.76406400000001,29.76427299999999,29.764466,29.76483699999999,29.76529899999999,29.76534199999999,29.76617500000001,29.76793200000001,29.76855,29.76864000000001,29.76900899999997,29.770218,29.77166700000001,29.777871,29.78045500000002,29.78448699999999,29.78400800000001,29.784485,29.78732899999999,29.789766,29.79063100000002,29.79126399999998,29.79172199999999,29.79254900000001,29.79378200000001,29.80120600000001]}]],[[{"lng":[-82.38884899999999,-82.388341,-82.38561299999999,-82.38569,-82.388593,-82.388728,-82.38877599999999,-82.38837599999999,-82.38400999999999,-82.381091,-82.377481,-82.36032800000001,-82.353686,-82.35417799999999,-82.354722,-82.356055,-82.35982199999999,-82.361649,-82.362359,-82.363764,-82.37260999999999,-82.38888799999999,-82.38884899999999],"lat":[29.70959599999999,29.711185,29.71550500000001,29.717417,29.722179,29.72287999999998,29.73930700000001,29.739304,29.73934499999999,29.736136,29.73223399999999,29.71748999999998,29.711902,29.70979599999999,29.70843900000001,29.70695600000002,29.70507599999999,29.704283,29.703949,29.70333099999998,29.703362,29.703259,29.70959599999999]}]],[[{"lng":[-82.495971,-82.495763,-82.49376199999999,-82.493133,-82.493296,-82.493318,-82.493514,-82.49351299999999,-82.493877,-82.49390699999999,-82.49394699999999,-82.493993,-82.494013,-82.494013,-82.494013,-82.49401399999999,-82.49427899999999,-82.49454,-82.49426199999999,-82.494169,-82.494209,-82.494253,-82.494259,-82.49106599999999,-82.48525599999999,-82.48257599999999,-82.48100199999999,-82.479759,-82.47739299999999,-82.47376799999999,-82.471497,-82.46391,-82.454792,-82.45487299999999,-82.454869,-82.45487199999999,-82.45528,-82.45421100000002,-82.43467299999999,-82.43154299999999,-82.428386,-82.42407299999999,-82.430527,-82.44524299999999,-82.448459,-82.451953,-82.466092,-82.471993,-82.490313,-82.493764,-82.495943,-82.495965,-82.495965,-82.49596799999999,-82.495969,-82.495971],"lat":[29.73279100000001,29.73485600000001,29.73901599999999,29.741442,29.74945600000001,29.750015,29.75612300000001,29.76336199999999,29.77152899999998,29.773245,29.77497599999997,29.77658799999999,29.777926,29.777959,29.77801700000001,29.778125,29.78292799999998,29.78331600000001,29.784225,29.78534299999998,29.78745600000003,29.791341,29.79378200000001,29.79254900000001,29.79172199999999,29.79126399999998,29.79063100000002,29.789766,29.78732899999999,29.784485,29.78400800000001,29.78448699999999,29.78045500000002,29.778354,29.75297399999998,29.75011399999999,29.745943,29.72958999999998,29.71761299999999,29.71421599999999,29.71313099999997,29.71067599999998,29.710466,29.71056000000003,29.71078900000001,29.711599,29.71632500000001,29.71811799999999,29.71829999999999,29.71831399999999,29.71832,29.722678,29.72368499999999,29.72865799999999,29.72896099999999,29.73279100000001]}]],[[{"lng":[-82.658554,-82.655512,-82.65455999999999,-82.653674,-82.652107,-82.649151,-82.644367,-82.64137700000001,-82.64062699999999,-82.635797,-82.63473399999999,-82.634587,-82.63501099999999,-82.634513,-82.631659,-82.63083,-82.630646,-82.626671,-82.624903,-82.62175000000001,-82.619781,-82.590698,-82.588357,-82.57998099999999,-82.562719,-82.56236299999999,-82.561801,-82.559978,-82.557514,-82.55435899999999,-82.543915,-82.53542899999999,-82.53297999999999,-82.52655799999999,-82.51403499999999,-82.50367399999999,-82.494259,-82.494253,-82.494209,-82.494169,-82.49426199999999,-82.49454,-82.49427899999999,-82.49401399999999,-82.494013,-82.494013,-82.494013,-82.493993,-82.49394699999999,-82.49390699999999,-82.493877,-82.49351299999999,-82.493514,-82.493318,-82.493296,-82.493133,-82.49376199999999,-82.495763,-82.495971,-82.495969,-82.49596799999999,-82.50349399999999,-82.50869,-82.54778,-82.581919,-82.607164,-82.61752199999999,-82.623713,-82.63623,-82.64037399999999,-82.64870999999999,-82.655202,-82.657043,-82.65722900000002,-82.65809700000001,-82.65812799999999,-82.658554],"lat":[29.83014399999999,29.82969299999999,29.82905199999999,29.82694300000001,29.82563,29.82648199999998,29.82679499999999,29.82742300000002,29.82884899999999,29.832351,29.833596,29.835252,29.838132,29.83965599999998,29.84146299999999,29.84246999999999,29.842782,29.84020999999998,29.83930099999999,29.83790799999998,29.83703800000001,29.82425,29.82345499999999,29.81972200000001,29.81213100000001,29.81197599999998,29.81176600000001,29.811207,29.810675,29.81002499999998,29.80790600000001,29.806176,29.805687,29.804382,29.80182299999999,29.79957000000002,29.79378200000001,29.791341,29.78745600000003,29.78534299999998,29.784225,29.78331600000001,29.78292799999998,29.778125,29.77801700000001,29.777959,29.777926,29.77658799999999,29.77497599999997,29.773245,29.77152899999998,29.76336199999999,29.75612300000001,29.750015,29.74945600000001,29.741442,29.73901599999999,29.73485600000001,29.73279100000001,29.72896099999999,29.72865799999999,29.72857,29.727398,29.72734899999999,29.72745200000001,29.72743400000001,29.727227,29.726945,29.72650200000002,29.72636599999998,29.726118,29.72605599999999,29.72663499999998,29.75146100000001,29.821778,29.82806799999999,29.83014399999999]}]],[[{"lng":[-82.466092,-82.451953,-82.448459,-82.44524299999999,-82.430527,-82.42407299999999,-82.41647399999999,-82.410381,-82.406268,-82.404881,-82.399005,-82.397357,-82.38888799999999,-82.388909,-82.388926,-82.38893,-82.38904699999999,-82.39231599999999,-82.397386,-82.40042,-82.40977699999999,-82.43056899999999,-82.44681799999999,-82.45450000000001,-82.45704499999999,-82.458906,-82.466092],"lat":[29.71632500000001,29.711599,29.71078900000001,29.71056000000003,29.710466,29.71067599999998,29.71056099999998,29.70575899999998,29.70367000000001,29.703286,29.70325200000002,29.70324799999999,29.703259,29.69649399999999,29.69376099999999,29.68873299999997,29.688724,29.688728,29.68873299999997,29.68877999999999,29.688833,29.68891099999999,29.68902599999999,29.69688600000001,29.69997599999998,29.702883,29.71632500000001]}]],[[{"lng":[-82.45487199999999,-82.454869,-82.44873699999999,-82.432586,-82.422068,-82.42209699999999,-82.41736899999999,-82.417952,-82.409702,-82.409688,-82.41671099999999,-82.41669399999999,-82.414756,-82.414011,-82.41474099999999,-82.406131,-82.405444,-82.389014,-82.38877599999999,-82.388728,-82.388593,-82.38569,-82.38561299999999,-82.388341,-82.38884899999999,-82.38888799999999,-82.397357,-82.399005,-82.404881,-82.406268,-82.410381,-82.41647399999999,-82.42407299999999,-82.428386,-82.43154299999999,-82.43467299999999,-82.45421100000002,-82.45528,-82.45487199999999],"lat":[29.75011399999999,29.75297399999998,29.75067700000001,29.73941800000002,29.73937700000001,29.73261599999999,29.73259600000001,29.72891799999999,29.728848,29.73254599999999,29.73258799999999,29.73573900000001,29.73609500000001,29.737144,29.739301,29.73929699999999,29.73930500000001,29.73930299999999,29.73930700000001,29.72287999999998,29.722179,29.717417,29.71550500000001,29.711185,29.70959599999999,29.703259,29.70324799999999,29.70325200000002,29.703286,29.70367000000001,29.70575899999998,29.71056099999998,29.71067599999998,29.71313099999997,29.71421599999999,29.71761299999999,29.72958999999998,29.745943,29.75011399999999]}]],[[{"lng":[-82.45487299999999,-82.454792,-82.44928299999999,-82.43348,-82.42830300000001,-82.423945,-82.422507,-82.42134999999999,-82.41902,-82.413265,-82.41049699999999,-82.40984999999999,-82.408795,-82.408062,-82.40773299999999,-82.40778899999999,-82.405681,-82.404595,-82.403673,-82.40203699999999,-82.38888100000001,-82.388352,-82.38793099999999,-82.38575500000002,-82.38400999999999,-82.38837599999999,-82.38877599999999,-82.389014,-82.405444,-82.406131,-82.41474099999999,-82.414011,-82.414756,-82.41669399999999,-82.41671099999999,-82.409688,-82.409702,-82.417952,-82.41736899999999,-82.42209699999999,-82.422068,-82.432586,-82.44873699999999,-82.454869,-82.45487299999999],"lat":[29.778354,29.78045500000002,29.777871,29.77166700000001,29.770218,29.76900899999997,29.76864000000001,29.76855,29.76793200000001,29.76617500000001,29.76534199999999,29.76529899999999,29.76483699999999,29.764466,29.76427299999999,29.76406400000001,29.762628,29.76170299999998,29.76075999999998,29.75933299999999,29.74482599999999,29.74418900000001,29.74370700000001,29.74131199999999,29.73934499999999,29.739304,29.73930700000001,29.73930299999999,29.73930500000001,29.73929699999999,29.739301,29.737144,29.73609500000001,29.73573900000001,29.73258799999999,29.73254599999999,29.728848,29.72891799999999,29.73259600000001,29.73261599999999,29.73937700000001,29.73941800000002,29.75067700000001,29.75297399999998,29.778354]}]],[[{"lng":[-82.343091,-82.32242599999999,-82.305774,-82.28496,-82.27874,-82.277492,-82.27408799999999,-82.264291,-82.255698,-82.25573299999999,-82.239226,-82.24105500000002,-82.24292200000001,-82.247494,-82.248053,-82.254454,-82.255336,-82.256147,-82.25794499999999,-82.258194,-82.265867,-82.268733,-82.28649399999999,-82.291313,-82.293869,-82.29104900000002,-82.29141,-82.289125,-82.289154,-82.28914700000001,-82.30222499999999,-82.301436,-82.30183,-82.29686799999999,-82.28928399999999,-82.295816,-82.29993899999999,-82.305789,-82.319368,-82.32590499999999,-82.338875,-82.343091],"lat":[29.703215,29.703182,29.70296899999999,29.70302699999997,29.70295099999997,29.70244,29.70746299999998,29.707526,29.707465,29.688234,29.68786,29.68737399999999,29.68610099999999,29.68181100000001,29.681287,29.67526299999999,29.67457299999999,29.67412299999999,29.67363099999999,29.67360499999999,29.67368700000001,29.67442400000002,29.683442,29.67653899999999,29.67381600000001,29.672477,29.67027299999999,29.66920200000001,29.66645099999999,29.66534200000001,29.665245,29.66655,29.666511,29.673817,29.68502500000001,29.68775900000002,29.68831699999998,29.688349,29.68841699999999,29.68846,29.69963599999999,29.703215]}]],[[{"lng":[-82.272278,-82.268901,-82.267375,-82.26587099999999,-82.24935499999999,-82.17985399999999,-82.17399500000001,-82.17172099999999,-82.16739199999999,-82.16684400000001,-82.16594599999999,-82.165256,-82.16417899999999,-82.163122,-82.16058,-82.159902,-82.14710000000001,-82.14656099999999,-82.13853,-82.13312599999999,-82.133127,-82.130178,-82.13024299999999,-82.12993299999999,-82.12392299999999,-82.124054,-82.12166999999999,-82.121695,-82.11964499999999,-82.119545,-82.11759699999999,-82.11755199999999,-82.10888899999999,-82.109123,-82.104355,-82.10124399999999,-82.098039,-82.094697,-82.09372599999999,-82.094319,-82.093543,-82.089759,-82.08449399999999,-82.08160599999999,-82.079348,-82.080035,-82.08004,-82.082095,-82.08362,-82.087504,-82.08815299999999,-82.085246,-82.082655,-82.076723,-82.07314199999999,-82.070708,-82.066856,-82.06033099999999,-82.057931,-82.05636800000001,-82.05510099999999,-82.05452799999999,-82.055025,-82.054389,-82.05454,-82.05399799999999,-82.05413,-82.055694,-82.05562499999999,-82.05547399999999,-82.05082899999999,-82.049052,-82.049981,-82.050291,-82.052521,-82.076966,-82.077713,-82.08031900000002,-82.087581,-82.09844099999999,-82.10036099999999,-82.12053899999999,-82.122186,-82.130561,-82.13262,-82.13963199999999,-82.140401,-82.15308399999999,-82.159786,-82.161,-82.17348,-82.20367400000001,-82.20532,-82.222511,-82.22484999999999,-82.23807099999999,-82.239226,-82.25573299999999,-82.255698,-82.264291,-82.27408799999999,-82.272278],"lat":[29.710161,29.71509799999998,29.716903,29.71825399999999,29.730311,29.780907,29.78518699999998,29.787215,29.790524,29.79028599999998,29.79116499999998,29.79192800000001,29.79337499999999,29.795237,29.80209599999998,29.80398399999999,29.838728,29.83589499999998,29.835959,29.83594899999999,29.83080999999999,29.83082300000001,29.825353,29.82367499999999,29.823686,29.805289,29.80533299999999,29.80185199999999,29.80184599999999,29.79822500000001,29.79818800000001,29.790595,29.79071300000001,29.783085,29.78328399999999,29.78335999999999,29.780941,29.78060599999999,29.78155200000002,29.78008899999999,29.77916500000001,29.77915999999999,29.778765,29.77805099999998,29.77600500000001,29.772231,29.76703800000001,29.76357200000001,29.76363799999998,29.761938,29.760931,29.76038599999999,29.76125099999998,29.76120800000001,29.76036099999998,29.75925,29.756511,29.750443,29.747822,29.744207,29.738139,29.73756199999999,29.73441600000001,29.732705,29.72894800000002,29.72786999999998,29.72520199999999,29.719745,29.718232,29.717209,29.71609800000001,29.71336799999999,29.713467,29.70973499999998,29.70972899999999,29.70699899999998,29.70699800000001,29.70760100000001,29.710849,29.71353299999999,29.71379399999999,29.713591,29.713895,29.71663000000001,29.716915,29.71676699999999,29.71670399999998,29.71357399999999,29.708378,29.707751,29.703711,29.68811100000002,29.68788899999999,29.687878,29.687883,29.687926,29.68786,29.688234,29.707465,29.707526,29.70746299999998,29.710161]}]],[[{"lng":[-82.384755,-82.371095,-82.371065,-82.371583,-82.37064099999999,-82.369456,-82.36891,-82.36734799999999,-82.367998,-82.370504,-82.372389,-82.37219399999999,-82.371332,-82.371409,-82.375327,-82.375084,-82.375328,-82.376791,-82.37668599999999,-82.378379,-82.37850399999999,-82.377107,-82.376571,-82.375861,-82.374318,-82.374377,-82.37477,-82.376508,-82.377763,-82.37743999999999,-82.378052,-82.376257,-82.377279,-82.379783,-82.37834099999999,-82.374528,-82.37389300000001,-82.37224500000001,-82.369524,-82.367846,-82.366117,-82.363069,-82.361548,-82.35839,-82.356421,-82.354086,-82.35135900000002,-82.350122,-82.348117,-82.343266,-82.33621099999999,-82.33496199999999,-82.332831,-82.329297,-82.32669199999999,-82.32583699999999,-82.32307899999999,-82.314176,-82.313914,-82.30520299999999,-82.305027,-82.299509,-82.295906,-82.294878,-82.29324299999999,-82.28962199999999,-82.289704,-82.286278,-82.283874,-82.281837,-82.27968899999999,-82.27817499999999,-82.275075,-82.27256299999999,-82.27177399999999,-82.26950699999999,-82.269606,-82.267061,-82.267826,-82.265019,-82.264005,-82.263655,-82.26037699999999,-82.25739200000001,-82.252488,-82.24955300000001,-82.247175,-82.24619799999999,-82.244135,-82.241061,-82.23815399999999,-82.238187,-82.233656,-82.233514,-82.219701,-82.210258,-82.21028299999999,-82.208398,-82.205851,-82.198076,-82.19448,-82.190271,-82.18825799999999,-82.18509,-82.182131,-82.17738,-82.173204,-82.16493199999999,-82.16191999999999,-82.14710000000001,-82.159902,-82.16058,-82.163122,-82.16417899999999,-82.165256,-82.16594599999999,-82.16684400000001,-82.16739199999999,-82.17172099999999,-82.17399500000001,-82.17985399999999,-82.24935499999999,-82.26587099999999,-82.267375,-82.268901,-82.272278,-82.27408799999999,-82.277492,-82.27874,-82.28496,-82.305774,-82.32242599999999,-82.343091,-82.353577,-82.35349699999999,-82.35409299999999,-82.353779,-82.354094,-82.35460599999999,-82.355223,-82.35616800000001,-82.356883,-82.357283,-82.35755800000001,-82.36961599999999,-82.37069,-82.37116,-82.37238499999999,-82.37831199999999,-82.38112,-82.383759,-82.384755],"lat":[29.80059499999999,29.80091700000001,29.80322199999999,29.804322,29.80666400000002,29.80728,29.80872399999999,29.80974199999999,29.811078,29.81163199999999,29.813591,29.81528600000001,29.81695099999999,29.81923299999999,29.826902,29.83196699999998,29.83496500000001,29.83638500000001,29.839945,29.841017,29.842656,29.84448799999999,29.845977,29.84712799999998,29.85031999999997,29.853967,29.85654599999999,29.857743,29.85962400000001,29.86095,29.86203399999998,29.86575099999999,29.86754999999999,29.869806,29.87452500000001,29.87705700000001,29.879292,29.87985199999999,29.879144,29.88041499999999,29.880454,29.88142899999999,29.88115400000002,29.87737099999999,29.87749299999998,29.87852799999999,29.877599,29.87822100000002,29.87678900000002,29.876613,29.878798,29.878714,29.87503699999998,29.87425600000002,29.87190299999997,29.86903100000001,29.86723300000001,29.86760399999999,29.85995899999999,29.85992400000001,29.85317100000001,29.85315799999999,29.852459,29.85091299999998,29.85119899999998,29.849801,29.84903700000002,29.84795799999999,29.84525699999998,29.84444799999999,29.844742,29.84407300000001,29.84424499999999,29.84301100000003,29.84323500000001,29.84403699999999,29.84492199999999,29.84581799999999,29.846416,29.84751300000002,29.847076,29.84662200000001,29.84656499999999,29.84847799999999,29.85008800000001,29.85009,29.85090600000001,29.85196199999997,29.85239199999999,29.852185,29.850754,29.84904,29.84898000000001,29.84529699999998,29.845304,29.84531499999999,29.84427600000001,29.84394900000001,29.84549000000002,29.84820700000001,29.84852099999999,29.84808699999999,29.84594699999998,29.84405,29.84068299999996,29.83799400000002,29.83697600000002,29.83956100000001,29.83874399999998,29.838728,29.80398399999999,29.80209599999998,29.795237,29.79337499999999,29.79192800000001,29.79116499999998,29.79028599999998,29.790524,29.787215,29.78518699999998,29.780907,29.730311,29.71825399999999,29.716903,29.71509799999998,29.710161,29.70746299999998,29.70244,29.70295099999997,29.70302699999997,29.70296899999999,29.703182,29.703215,29.71223400000001,29.71443499999999,29.72176600000002,29.74016499999999,29.74222,29.74493100000001,29.74799599999999,29.75283499999999,29.756272,29.757248,29.75778499999999,29.77332600000001,29.77503799999999,29.77571300000001,29.777693,29.787015,29.79201899999999,29.79714899999998,29.80059499999999]}]],[[{"lng":[-82.25673700000002,-82.256339,-82.254178,-82.25062,-82.248549,-82.24280899999999,-82.237161,-82.23782899999999,-82.236791,-82.237664,-82.239234,-82.239525,-82.240792,-82.239501,-82.239378,-82.23765499999999,-82.23700099999999,-82.234673,-82.23597599999999,-82.23850400000001,-82.238247,-82.225064,-82.22484999999999,-82.222511,-82.20532,-82.20367400000001,-82.17348,-82.161,-82.159786,-82.15308399999999,-82.140401,-82.13963199999999,-82.13262,-82.130561,-82.122186,-82.12053899999999,-82.10036099999999,-82.09844099999999,-82.087581,-82.08031900000002,-82.077713,-82.076966,-82.052521,-82.050291,-82.052302,-82.052741,-82.05502700000001,-82.056071,-82.056151,-82.05601399999999,-82.055961,-82.05533699999999,-82.055413,-82.055363,-82.055527,-82.05610399999999,-82.05595699999999,-82.055899,-82.05564299999999,-82.056747,-82.059614,-82.064016,-82.065089,-82.067155,-82.071291,-82.071726,-82.07032599999999,-82.07041199999999,-82.07402399999999,-82.07610199999999,-82.07590100000002,-82.07838699999999,-82.08094299999999,-82.083806,-82.085674,-82.08761299999999,-82.08874399999999,-82.08669200000001,-82.08605299999999,-82.08827699999999,-82.086517,-82.08812300000001,-82.089427,-82.08892999999999,-82.090473,-82.09095099999999,-82.09198599999999,-82.092671,-82.093048,-82.094537,-82.09572899999999,-82.095455,-82.096874,-82.096683,-82.095524,-82.095629,-82.099886,-82.098839,-82.09967399999999,-82.099425,-82.097787,-82.096817,-82.09851499999999,-82.098716,-82.096999,-82.09589699999999,-82.097859,-82.09751,-82.098787,-82.09943799999999,-82.098767,-82.100499,-82.10114299999999,-82.104124,-82.10523099999999,-82.105688,-82.105914,-82.10979499999999,-82.10830799999999,-82.108232,-82.10898299999999,-82.113674,-82.118291,-82.126582,-82.128255,-82.132699,-82.136383,-82.144757,-82.158238,-82.15929,-82.15961399999999,-82.159616,-82.160371,-82.161402,-82.16792799999999,-82.1703,-82.17065199999999,-82.171875,-82.17186699999999,-82.17212499999999,-82.17293099999999,-82.18745299999999,-82.188406,-82.18877499999999,-82.188757,-82.188951,-82.2483,-82.249189,-82.25184000000002,-82.25155599999999,-82.25262599999999,-82.25496099999999,-82.25651999999999,-82.25765000000001,-82.25673700000002],"lat":[29.62584199999998,29.628383,29.630203,29.63143299999999,29.633125,29.63619200000002,29.63633699999998,29.63805899999998,29.64025899999999,29.64723399999999,29.65122699999999,29.65426900000001,29.655462,29.65668399999999,29.66126000000001,29.667015,29.670073,29.673528,29.67353700000001,29.67563499999999,29.67586100000001,29.68743,29.687883,29.687878,29.68788899999999,29.68811100000002,29.703711,29.707751,29.708378,29.71357399999999,29.71670399999998,29.71676699999999,29.716915,29.71663000000001,29.713895,29.713591,29.71379399999999,29.71353299999999,29.710849,29.70760100000001,29.70699800000001,29.70699899999998,29.70972899999999,29.70973499999998,29.69054299999998,29.68844199999999,29.66960800000001,29.656846,29.64535500000001,29.64353200000002,29.631151,29.59481999999998,29.594097,29.56581400000002,29.563922,29.50802,29.50690799999999,29.471232,29.44184699999999,29.439951,29.43933100000001,29.43957599999999,29.44190000000002,29.443798,29.443271,29.442609,29.43919499999999,29.434445,29.434647,29.43681999999997,29.43874999999997,29.44014900000002,29.44038600000001,29.43789200000002,29.43723,29.43570399999999,29.43322099999999,29.432123,29.43110600000002,29.428971,29.42677,29.42619799999999,29.428046,29.42894199999999,29.429669,29.43093600000002,29.430754,29.42923200000001,29.43063199999999,29.430352,29.428781,29.42781100000001,29.425242,29.423731,29.42177599999999,29.420499,29.41866399999997,29.41976099999997,29.421109,29.422489,29.421062,29.42183499999999,29.424337,29.42725799999999,29.42824400000002,29.430316,29.43167199999998,29.43314099999997,29.43327,29.43465799999999,29.43606200000001,29.43658399999999,29.438313,29.43827300000002,29.437636,29.435966,29.43570900000002,29.43537899999998,29.444774,29.44704400000002,29.45346999999999,29.45456999999999,29.455332,29.455116,29.45531699999999,29.456593,29.45907099999999,29.46386099999999,29.47531,29.47647200000001,29.477338,29.48493100000001,29.486118,29.486379,29.48637100000001,29.48772200000001,29.488881,29.49850099999999,29.511913,29.51294399999998,29.51401699999999,29.52670500000001,29.52774900000002,29.52931599999999,29.53876999999999,29.598992,29.61117200000001,29.615098,29.61774099999999,29.61844500000002,29.61878599999999,29.62106499999999,29.624272,29.62499499999999,29.62584199999998]}]],[[{"lng":[-82.39370799999999,-82.392499,-82.392093,-82.390609,-82.38782399999999,-82.38682299999999,-82.383284,-82.382474,-82.380252,-82.378321,-82.37447499999999,-82.36882000000001,-82.36473199999999,-82.357985,-82.349211,-82.361407,-82.363213,-82.37343299999999,-82.371014,-82.370367,-82.362489,-82.360928,-82.35924299999999,-82.33918600000001,-82.33944099999999,-82.341149,-82.34215999999999,-82.34136599999999,-82.339868,-82.339524,-82.3374,-82.33666599999999,-82.335588,-82.33460599999999,-82.33366199999999,-82.32987,-82.32859499999999,-82.327989,-82.327388,-82.326803,-82.322322,-82.31807999999999,-82.31807599999999,-82.311167,-82.30873699999999,-82.30862599999999,-82.30800499999999,-82.30754899999999,-82.305239,-82.304558,-82.300635,-82.298141,-82.295917,-82.295284,-82.292648,-82.284077,-82.28230599999999,-82.27337500000002,-82.27194600000001,-82.263114,-82.253957,-82.248103,-82.2483,-82.188951,-82.188757,-82.18877499999999,-82.188406,-82.18745299999999,-82.17293099999999,-82.17212499999999,-82.17186699999999,-82.171875,-82.17065199999999,-82.1703,-82.16792799999999,-82.161402,-82.160371,-82.159616,-82.15961399999999,-82.15929,-82.158238,-82.144757,-82.136383,-82.132699,-82.128255,-82.126582,-82.118291,-82.113674,-82.10898299999999,-82.108232,-82.10830799999999,-82.10979499999999,-82.11193299999999,-82.11388599999999,-82.11600399999999,-82.11778199999999,-82.11833299999999,-82.12114799999999,-82.12523899999999,-82.12719299999999,-82.12661299999999,-82.128096,-82.128637,-82.131973,-82.13358099999999,-82.13546599999999,-82.13670499999999,-82.13782399999999,-82.137586,-82.141024,-82.140849,-82.142483,-82.14406,-82.14417399999999,-82.145298,-82.14251,-82.140563,-82.140338,-82.141758,-82.143479,-82.14502,-82.14617500000001,-82.147532,-82.148827,-82.14946700000002,-82.15101799999999,-82.151552,-82.150019,-82.15065799999999,-82.15365,-82.15307899999999,-82.156301,-82.15487499999999,-82.155762,-82.15728899999999,-82.15908499999999,-82.162862,-82.16515500000001,-82.167888,-82.16842299999999,-82.167267,-82.170502,-82.17339899999999,-82.172281,-82.173682,-82.17549199999999,-82.175825,-82.17813099999999,-82.180387,-82.183233,-82.19362599999999,-82.198043,-82.19773500000001,-82.200079,-82.200142,-82.202122,-82.20362399999999,-82.20723699999999,-82.21016499999999,-82.213245,-82.213731,-82.212475,-82.213644,-82.212846,-82.212886,-82.211314,-82.211704,-82.21157199999999,-82.214596,-82.21408699999999,-82.21687799999999,-82.21772199999999,-82.21644599999999,-82.214929,-82.213398,-82.213703,-82.211782,-82.212727,-82.21166099999999,-82.209548,-82.20885699999999,-82.20662399999999,-82.20527199999999,-82.204183,-82.19896399999999,-82.19608300000002,-82.19448600000001,-82.193455,-82.193347,-82.19558099999999,-82.198623,-82.19901299999999,-82.196331,-82.19227099999999,-82.188795,-82.18811599999999,-82.189172,-82.19081299999999,-82.18936699999999,-82.191844,-82.192837,-82.196703,-82.19919899999999,-82.201161,-82.20018,-82.201639,-82.20350000000001,-82.204556,-82.20583200000002,-82.206643,-82.20533499999999,-82.20716999999999,-82.20817,-82.20830300000002,-82.21145799999999,-82.212012,-82.210623,-82.211686,-82.214811,-82.21332799999999,-82.21097,-82.210336,-82.21164400000001,-82.211235,-82.21400199999999,-82.215143,-82.24388999999999,-82.24908499999999,-82.26448599999999,-82.26793499999999,-82.27143799999999,-82.272707,-82.279298,-82.279465,-82.2889,-82.291674,-82.302829,-82.313085,-82.31387599999999,-82.32804399999999,-82.386702,-82.38913199999999,-82.39079199999999,-82.390911,-82.391268,-82.393547,-82.39370799999999],"lat":[29.56976400000001,29.575932,29.58004699999999,29.58008199999999,29.57830999999999,29.576198,29.57412400000001,29.573057,29.57148499999999,29.57063299999998,29.56962200000001,29.568919,29.56810600000001,29.56630700000002,29.56649400000001,29.587967,29.590539,29.602043,29.60378000000001,29.60282699999999,29.594643,29.59347799999999,29.59315600000001,29.594704,29.598084,29.60203300000001,29.60551700000001,29.61168599999999,29.61492,29.61498700000001,29.615839,29.61614799999999,29.61645500000001,29.61698600000002,29.61753500000001,29.61970100000001,29.62045999999999,29.620898,29.621426,29.62205300000002,29.62952199999999,29.629879,29.627739,29.62765499999999,29.61909399999999,29.617346,29.61534600000001,29.613464,29.609356,29.60872499999999,29.60743299999999,29.607448,29.60571499999998,29.60174599999998,29.598476,29.59583599999998,29.59644900000001,29.603528,29.607762,29.61329300000002,29.61206799999999,29.61076900000002,29.61117200000001,29.598992,29.53876999999999,29.52931599999999,29.52774900000002,29.52670500000001,29.51401699999999,29.51294399999998,29.511913,29.49850099999999,29.488881,29.48772200000001,29.48637100000001,29.486379,29.486118,29.48493100000001,29.477338,29.47647200000001,29.47531,29.46386099999999,29.45907099999999,29.456593,29.45531699999999,29.455116,29.455332,29.45456999999999,29.45346999999999,29.44704400000002,29.444774,29.43537899999998,29.43501299999998,29.43230600000002,29.432558,29.43190299999999,29.428475,29.42898,29.42887000000001,29.430048,29.432348,29.43305800000003,29.43224399999999,29.43335099999999,29.43493099999999,29.43466699999999,29.43283,29.43252299999999,29.43103200000001,29.428634,29.42790799999999,29.426429,29.426606,29.424928,29.42345899999998,29.42175299999999,29.42152699999998,29.420075,29.41978899999998,29.41846899999999,29.41807699999999,29.418052,29.417552,29.41705699999999,29.42007199999998,29.420512,29.421723,29.42290499999999,29.426498,29.42427,29.42240499999999,29.42564099999998,29.42366599999998,29.42236699999998,29.42246099999999,29.42487699999998,29.42444799999998,29.42500400000001,29.42716699999999,29.425703,29.42455899999998,29.425258,29.42404799999998,29.42327199999999,29.42183099999999,29.42196899999999,29.42065999999999,29.42249199999999,29.42228800000001,29.421287,29.42093499999999,29.42307999999998,29.422095,29.42276099999999,29.424097,29.42640199999999,29.426946,29.42727000000001,29.428496,29.431764,29.437017,29.44020700000002,29.441022,29.44198900000002,29.444356,29.44777199999998,29.44789800000001,29.44950399999999,29.451985,29.45299699999999,29.45504000000001,29.45709500000002,29.46019699999998,29.46139200000001,29.46167600000001,29.462905,29.46400799999998,29.46562299999999,29.46605599999999,29.46450999999999,29.46326899999999,29.46168999999998,29.46233000000001,29.46056800000001,29.46066200000001,29.462715,29.461319,29.46143999999999,29.45979699999999,29.457583,29.45795000000002,29.45577199999999,29.45489199999999,29.45253800000002,29.454425,29.456911,29.45896899999998,29.45974999999999,29.461125,29.463034,29.46225799999999,29.464123,29.46652599999999,29.46746099999999,29.46827599999999,29.46911699999998,29.47213699999998,29.47127799999999,29.47231799999999,29.47067299999999,29.46705400000001,29.46606900000001,29.46676199999999,29.470777,29.470881,29.47210200000001,29.47408800000001,29.47408800000001,29.47731100000003,29.47892299999999,29.47967200000002,29.48131700000001,29.482741,29.48393500000001,29.48341199999998,29.484213,29.484271,29.48771,29.50164999999998,29.50206299999999,29.50252499999997,29.50269199999999,29.503601,29.51111699999998,29.513434,29.51436299999999,29.52214399999999,29.522825,29.523236,29.53566799999999,29.55176799999999,29.553137,29.55667299999998,29.556292,29.55891400000002,29.56815700000003,29.56976400000001]}]],[[{"lng":[-82.407471,-82.40681699999999,-82.406593,-82.40650000000001,-82.40636099999999,-82.406249,-82.401495,-82.40095699999999,-82.39870499999999,-82.39157399999999,-82.390911,-82.39079199999999,-82.38913199999999,-82.386702,-82.32804399999999,-82.31387599999999,-82.313085,-82.302829,-82.291674,-82.2889,-82.279465,-82.279298,-82.272707,-82.27143799999999,-82.26793499999999,-82.26448599999999,-82.24908499999999,-82.24388999999999,-82.244236,-82.28749599999999,-82.40661999999999,-82.412932,-82.407471],"lat":[29.49304899999998,29.49454600000001,29.49553199999999,29.49935599999996,29.52234400000001,29.523251,29.53791300000001,29.539265,29.543017,29.55362499999998,29.556292,29.55667299999998,29.553137,29.55176799999999,29.53566799999999,29.523236,29.522825,29.52214399999999,29.51436299999999,29.513434,29.51111699999998,29.503601,29.50269199999999,29.50252499999997,29.50206299999999,29.50164999999998,29.48771,29.484271,29.48425299999999,29.48432599999999,29.48504799999997,29.485092,29.49304899999998]}]],[[{"lng":[-82.607164,-82.581919,-82.54778,-82.50869,-82.50349399999999,-82.49596799999999,-82.495965,-82.495965,-82.495943,-82.495963,-82.49598499999999,-82.49603999999999,-82.49609099999999,-82.52071699999999,-82.527665,-82.529106,-82.531913,-82.540397,-82.545982,-82.549689,-82.55168999999999,-82.57464999999999,-82.57566,-82.57872100000002,-82.579734,-82.58182099999999,-82.58598599999999,-82.592016,-82.594284,-82.59661,-82.59827199999999,-82.600205,-82.602142,-82.60425599999999,-82.60663,-82.60703699999999,-82.60704699999999,-82.60705,-82.60707099999999,-82.60712099999999,-82.607114,-82.607135,-82.60715399999999,-82.60717199999999,-82.607164],"lat":[29.72743400000001,29.72745200000001,29.72734899999999,29.727398,29.72857,29.72865799999999,29.72368499999999,29.722678,29.71832,29.71619000000001,29.68922700000001,29.654024,29.654024,29.65415699999999,29.654149,29.65413300000001,29.654154,29.65425900000001,29.65437799999999,29.654662,29.654724,29.65443,29.65442100000002,29.654384,29.65437100000001,29.65433900000002,29.65429199999998,29.65416500000001,29.65362099999999,29.65231899999999,29.65069699999998,29.64860100000001,29.647355,29.64671599999999,29.64649900000001,29.68472999999999,29.68648500000001,29.68738999999998,29.691033,29.70874899999999,29.712833,29.71429299999999,29.72014,29.72560900000002,29.72743400000001]}]],[[{"lng":[-82.60663,-82.60425599999999,-82.602142,-82.600205,-82.59827199999999,-82.59661,-82.594284,-82.592016,-82.58598599999999,-82.58182099999999,-82.579734,-82.57872100000002,-82.57566,-82.57464999999999,-82.55168999999999,-82.549689,-82.545982,-82.540397,-82.531913,-82.529106,-82.527665,-82.52071699999999,-82.49609099999999,-82.49603999999999,-82.48906199999999,-82.472396,-82.47252999999999,-82.472607,-82.472926,-82.47304799999999,-82.49877499999999,-82.50576300000002,-82.508606,-82.50872099999999,-82.51910699999999,-82.51921299999999,-82.522223,-82.523303,-82.524035,-82.528306,-82.54007899999999,-82.54831799999999,-82.555442,-82.55662099999999,-82.57090199999999,-82.573132,-82.57734099999999,-82.586626,-82.58977000000002,-82.596255,-82.59900500000001,-82.59970799999999,-82.60033799999999,-82.604055,-82.60528699999999,-82.60627099999999,-82.606565,-82.60663],"lat":[29.64649900000001,29.64671599999999,29.647355,29.64860100000001,29.65069699999998,29.65231899999999,29.65362099999999,29.65416500000001,29.65429199999998,29.65433900000002,29.65437100000001,29.654384,29.65442100000002,29.65443,29.654724,29.654662,29.65437799999999,29.65425900000001,29.654154,29.65413300000001,29.654149,29.65415699999999,29.654024,29.654024,29.654161,29.65989199999999,29.64538799999999,29.63079399999999,29.58699099999998,29.56782,29.549131,29.54492399999999,29.543303,29.54323699999999,29.53704199999999,29.53838600000001,29.544009,29.545809,29.54678700000001,29.55202499999999,29.56649400000001,29.57662699999999,29.58531700000001,29.58631899999999,29.597815,29.59960199999999,29.60297200000002,29.61042400000001,29.61291799999999,29.61830000000002,29.62252599999999,29.62365500000001,29.624667,29.630551,29.63281,29.63552999999999,29.63722499999999,29.64649900000001]}]],[[{"lng":[-82.49598499999999,-82.495963,-82.495943,-82.493764,-82.490313,-82.471993,-82.466092,-82.458906,-82.45704499999999,-82.45450000000001,-82.44681799999999,-82.432548,-82.42339,-82.41937399999999,-82.41912599999999,-82.422369,-82.42777799999999,-82.430982,-82.438934,-82.44149,-82.446607,-82.458383,-82.47125199999999,-82.472396,-82.48906199999999,-82.49603999999999,-82.49598499999999],"lat":[29.68922700000001,29.71619000000001,29.71832,29.71831399999999,29.71829999999999,29.71811799999999,29.71632500000001,29.702883,29.69997599999998,29.69688600000001,29.68902599999999,29.674307,29.664706,29.65998599999998,29.65969399999998,29.65974999999997,29.65981199999999,29.66040699999999,29.660262,29.66001999999998,29.65994400000001,29.659996,29.66004800000001,29.65989199999999,29.654161,29.654024,29.68922700000001]}]],[[{"lng":[-82.472926,-82.472607,-82.445565,-82.439196,-82.42247399999999,-82.422541,-82.422544,-82.42260899999999,-82.42254199999999,-82.42197500000002,-82.42376,-82.43895599999999,-82.453442,-82.456546,-82.45637700000002,-82.47304799999999,-82.472926],"lat":[29.58699099999998,29.63079399999999,29.630588,29.630466,29.630509,29.616321,29.615957,29.61029100000001,29.60048700000001,29.59860400000001,29.59768100000001,29.58965699999998,29.58194499999999,29.57981099999999,29.57960500000001,29.56782,29.58699099999998]}]],[[{"lng":[-82.439093,-82.438934,-82.430982,-82.42777799999999,-82.422369,-82.422386,-82.422406,-82.42241199999999,-82.422417,-82.42241399999999,-82.422443,-82.42244099999999,-82.42245,-82.422455,-82.42247399999999,-82.439196,-82.439093],"lat":[29.645145,29.660262,29.66040699999999,29.65981199999999,29.65974999999997,29.656307,29.654199,29.65335500000002,29.65129099999998,29.64918100000001,29.645129,29.64097500000001,29.63878699999999,29.63677800000001,29.630509,29.630466,29.645145]}]],[[{"lng":[-82.47252999999999,-82.472396,-82.47125199999999,-82.458383,-82.446607,-82.44149,-82.438934,-82.439093,-82.439196,-82.445565,-82.472607,-82.47252999999999],"lat":[29.64538799999999,29.65989199999999,29.66004800000001,29.659996,29.65994400000001,29.66001999999998,29.660262,29.645145,29.630466,29.630588,29.63079399999999,29.64538799999999]}]],[[{"lng":[-82.556635,-82.556511,-82.55062199999999,-82.543418,-82.53993899999999,-82.533694,-82.51910699999999,-82.50872099999999,-82.508606,-82.50576300000002,-82.49877499999999,-82.47304799999999,-82.45637700000002,-82.456546,-82.453442,-82.43895599999999,-82.42376,-82.42274999999999,-82.422832,-82.405478,-82.40254999999999,-82.39954999999999,-82.392499,-82.39370799999999,-82.393547,-82.391268,-82.390911,-82.39157399999999,-82.39870499999999,-82.40095699999999,-82.401495,-82.406249,-82.40636099999999,-82.40650000000001,-82.406593,-82.40681699999999,-82.407471,-82.412932,-82.44769599999999,-82.451522,-82.46660299999999,-82.49081699999999,-82.496247,-82.496331,-82.49982799999999,-82.523096,-82.556591,-82.556921,-82.556635],"lat":[29.50617799999999,29.511982,29.51560999999999,29.52048599999998,29.52287099999999,29.52713199999999,29.53704199999999,29.54323699999999,29.543303,29.54492399999999,29.549131,29.56782,29.57960500000001,29.57981099999999,29.58194499999999,29.58965699999998,29.59768100000001,29.59516300000001,29.57647199999999,29.57628900000001,29.57616499999999,29.575378,29.575932,29.56976400000001,29.56815700000003,29.55891400000002,29.556292,29.55362499999998,29.543017,29.539265,29.53791300000001,29.523251,29.52234400000001,29.49935599999996,29.49553199999999,29.49454600000001,29.49304899999998,29.485092,29.48538600000001,29.48521500000001,29.48507,29.485419,29.48549899999999,29.47837100000001,29.478678,29.479266,29.480072,29.50024500000001,29.50617799999999]}]],[[{"lng":[-82.657043,-82.655202,-82.64870999999999,-82.64037399999999,-82.63623,-82.623713,-82.61752199999999,-82.607164,-82.60717199999999,-82.60715399999999,-82.607135,-82.607114,-82.60712099999999,-82.60707099999999,-82.60705,-82.60704699999999,-82.60703699999999,-82.60663,-82.606565,-82.60627099999999,-82.60528699999999,-82.604055,-82.60033799999999,-82.59970799999999,-82.59900500000001,-82.596255,-82.58977000000002,-82.586626,-82.57734099999999,-82.573132,-82.57090199999999,-82.55662099999999,-82.555442,-82.54831799999999,-82.54007899999999,-82.528306,-82.524035,-82.523303,-82.522223,-82.51921299999999,-82.51910699999999,-82.533694,-82.53993899999999,-82.543418,-82.55062199999999,-82.556511,-82.556669,-82.557007,-82.55710599999999,-82.568411,-82.573579,-82.58917099999999,-82.63620899999999,-82.63949599999999,-82.65633099999999,-82.65638199999999,-82.656133,-82.656335,-82.656301,-82.65630299999999,-82.65645099999999,-82.65633799999999,-82.656272,-82.656295,-82.65629799999999,-82.656312,-82.65628100000001,-82.65629299999999,-82.65629899999999,-82.65628599999999,-82.656284,-82.656297,-82.65631999999999,-82.65643399999999,-82.65655099999999,-82.65657,-82.65701899999999,-82.656898,-82.656927,-82.65690499999999,-82.657043],"lat":[29.72663499999998,29.72605599999999,29.726118,29.72636599999998,29.72650200000002,29.726945,29.727227,29.72743400000001,29.72560900000002,29.72014,29.71429299999999,29.712833,29.70874899999999,29.691033,29.68738999999998,29.68648500000001,29.68472999999999,29.64649900000001,29.63722499999999,29.63552999999999,29.63281,29.630551,29.624667,29.62365500000001,29.62252599999999,29.61830000000002,29.61291799999999,29.61042400000001,29.60297200000002,29.59960199999999,29.597815,29.58631899999999,29.58531700000001,29.57662699999999,29.56649400000001,29.55202499999999,29.54678700000001,29.545809,29.544009,29.53838600000001,29.53704199999999,29.52713199999999,29.52287099999999,29.52048599999998,29.51560999999999,29.511982,29.534556,29.53731099999999,29.537466,29.53768499999998,29.537483,29.53784899999999,29.53605299999998,29.53614400000002,29.53562000000001,29.55032500000002,29.55083,29.55089499999999,29.56481099999999,29.5649,29.57222699999998,29.58239300000003,29.58353399999999,29.59626599999999,29.60138899999999,29.603582,29.619954,29.62291500000002,29.62422399999999,29.62735000000001,29.627463,29.627862,29.63705900000001,29.64314599999999,29.64764200000001,29.679848,29.68196,29.68520699999997,29.68907100000001,29.71129899999999,29.72663499999998]}]],[[{"lng":[-82.42241399999999,-82.422417,-82.42241199999999,-82.422406,-82.422386,-82.422369,-82.41912599999999,-82.41900099999999,-82.40850499999999,-82.402349,-82.40721099999999,-82.40721000000001,-82.407264,-82.40970299999999,-82.411965,-82.413669,-82.41399299999999,-82.422443,-82.42241399999999],"lat":[29.64918100000001,29.65129099999998,29.65335500000002,29.654199,29.656307,29.65974999999997,29.65969399999998,29.65954799999999,29.64717499999999,29.639912,29.63994100000001,29.64007100000001,29.64170299999999,29.644968,29.645013,29.645098,29.64509800000002,29.645129,29.64918100000001]}]],[[{"lng":[-82.422455,-82.42245,-82.42244099999999,-82.422443,-82.41399299999999,-82.413669,-82.411965,-82.40970299999999,-82.407264,-82.40721000000001,-82.40721099999999,-82.410189,-82.411863,-82.41285599999999,-82.415302,-82.41631099999999,-82.41864,-82.42247399999999,-82.422455],"lat":[29.63677800000001,29.63878699999999,29.64097500000001,29.645129,29.64509800000002,29.645098,29.645013,29.644968,29.64170299999999,29.64007100000001,29.63994100000001,29.63944600000001,29.63842000000001,29.63729099999998,29.632998,29.63195199999999,29.630753,29.630509,29.63677800000001]}]],[[{"lng":[-82.422544,-82.422541,-82.42247399999999,-82.41864,-82.41631099999999,-82.415302,-82.41285599999999,-82.411863,-82.410189,-82.40721099999999,-82.402349,-82.39590100000001,-82.395295,-82.39103999999999,-82.390157,-82.38623600000001,-82.38786999999999,-82.39397199999999,-82.395764,-82.409099,-82.42197500000002,-82.42254199999999,-82.42260899999999,-82.422544],"lat":[29.615957,29.616321,29.630509,29.630753,29.63195199999999,29.632998,29.63729099999998,29.63842000000001,29.63944600000001,29.63994100000001,29.639912,29.63101299999997,29.63015499999998,29.624122,29.62286999999999,29.61729800000001,29.61644599999999,29.61331599999999,29.612381,29.60535699999999,29.59860400000001,29.60048700000001,29.61029100000001,29.615957]}]],[[{"lng":[-82.42376,-82.42197500000002,-82.409099,-82.395764,-82.39397199999999,-82.38786999999999,-82.38623600000001,-82.38326499999999,-82.377989,-82.37559299999999,-82.37343299999999,-82.363213,-82.361407,-82.349211,-82.357985,-82.36473199999999,-82.36882000000001,-82.37447499999999,-82.378321,-82.380252,-82.382474,-82.383284,-82.38682299999999,-82.38782399999999,-82.390609,-82.392093,-82.392499,-82.39954999999999,-82.40254999999999,-82.405478,-82.422832,-82.42274999999999,-82.42376],"lat":[29.59768100000001,29.59860400000001,29.60535699999999,29.612381,29.61331599999999,29.61644599999999,29.61729800000001,29.61321999999999,29.60713399999999,29.60446599999999,29.602043,29.590539,29.587967,29.56649400000001,29.56630700000002,29.56810600000001,29.568919,29.56962200000001,29.57063299999998,29.57148499999999,29.573057,29.57412400000001,29.576198,29.57830999999999,29.58008199999999,29.58004699999999,29.575932,29.575378,29.57616499999999,29.57628900000001,29.57647199999999,29.59516300000001,29.59768100000001]}]],[[{"lng":[-82.371014,-82.365318,-82.360736,-82.35909599999999,-82.356562,-82.355058,-82.35577700000002,-82.35606799999999,-82.35619899999999,-82.35634499999999,-82.35677400000002,-82.35586300000001,-82.35418799999999,-82.35129599999999,-82.350641,-82.34841900000001,-82.34707200000001,-82.345428,-82.34540899999999,-82.34402299999999,-82.34077099999999,-82.339879,-82.340013,-82.34085499999999,-82.339868,-82.34136599999999,-82.34215999999999,-82.341149,-82.33944099999999,-82.33918600000001,-82.35924299999999,-82.360928,-82.362489,-82.370367,-82.371014],"lat":[29.60378000000001,29.60789299999999,29.611222,29.61213499999997,29.61319499999999,29.61362900000003,29.620275,29.62353999999999,29.625039,29.625605,29.62638899999999,29.62651700000001,29.626537,29.62486899999998,29.62362599999999,29.62324199999999,29.62398999999998,29.62258199999999,29.621966,29.62137799999999,29.621293,29.621431,29.62053299999999,29.61484999999999,29.61492,29.61168599999999,29.60551700000001,29.60203300000001,29.598084,29.594704,29.59315600000001,29.59347799999999,29.594643,29.60282699999999,29.60378000000001]}]]],null,"% with health<br/>insurance",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":["#58CD65","#00B488","#006892","#00AC8E","#00AC8E","#006290","#363D7C","#00B488","#00AC8E","#58CD65","#C1DE35","#DAE12C","#6AD05F","#7BD358","#25C771","#00B488","#008A98","#007996","#00B884","#006E94","#00568A","#25C771","#008F97","#009996","#00BC80","#009497","#00B884","#00C376","#007F97","#00B884","#007495","#00B884","#00B08B","#009497","#00C07B","#B4DC3B","#007F97","#007996","#009996","#00A790","#009996","#00A790","#481964","#00B488","#00B488","#8AD651","#8AD651","#6AD05F","#8AD651","#43CA6B","#A6DA42","#155087","#363D7C","#008498","#009E94","#25C771"],"fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6],"smoothFactor":1,"noClip":false},["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000200&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>95.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000301&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000302&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>84.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>6.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000400&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>91.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000500&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>91.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000600&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>84.1&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000700&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>81.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>7.0&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000806&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000808&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>90.9&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.5&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000809&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>95.1&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000901&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>98.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>0.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001000902&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>99.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>0.5&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001000&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>95.8&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001100&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>96.2&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001201&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>94.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001202&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>91.9&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.9&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001203&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>87.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001400&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>86.1&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.5&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001514&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.2&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001515&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>85.2&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>6.2&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>21&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001516&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>83.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>6.3&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>22&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001517&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>94.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>23&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001519&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>87.9&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>24&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001520&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>88.8&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.2&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>25&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001521&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.7&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>26&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001603&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>88.3&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>27&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001604&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>28&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001701&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>93.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.0&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>29&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001702&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>86.7&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>9.0&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>30&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001801&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.1&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>31&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001802&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>85.7&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>7.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>32&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001803&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.3&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.0&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>33&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001805&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>91.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>34&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001806&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>88.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>35&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001811&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>93.2&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>36&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001813&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>97.9&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>1.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>37&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001814&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>86.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>8.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>38&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001902&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>86.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.9&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>39&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001907&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>88.8&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>40&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001001908&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>90.2&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>41&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002000&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>89.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>42&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002101&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>90.2&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>43&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002102&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>78.8&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>9.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>44&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002201&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>91.7&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.3&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>45&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002202&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>92.0&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>7.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>46&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002204&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>96.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>47&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002205&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>96.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>1.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>48&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002207&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>95.7&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.4&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>49&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002208&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>96.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.6&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>50&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002209&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>94.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>2.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>51&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002210&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>97.4&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>1.7&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>52&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002217&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>82.8&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>7.1&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>53&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002218&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>81.6&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>6.8&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>54&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002219&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>87.1&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>4.3&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>55&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001002220&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>89.5&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>5.3&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>56&emsp;<\/td><\/tr><tr><td>1<\/td><th>GEOID&emsp;<\/th><td>12001110800&emsp;<\/td><\/tr><tr><td>2<\/td><th>pct_insured&emsp;<\/th><td>94.3&emsp;<\/td><\/tr><tr><td>3<\/td><th>pct_insured_moe&emsp;<\/th><td>3.5&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_MULTIPOLYGON&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["95","92","84.5","91","91","84.1","81.6","92","90.9","95.1","98.4","99.6","95.8","96.2","94.4","91.9","87.4","86.1","92.4","85.2","83.5","94","87.9","88.8","92.7","88.3","92.5","93.6","86.7","92.1","85.7","92.3","91.4","88.6","93.2","97.9","86.6","86","88.8","90.2","89","90.2","78.8","91.7","92","96.6","96.5","95.7","96.4","94.5","97.4","82.8","81.6","87.1","89.5","94.3"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-82.658554,29.41705699999999,-82.049052,29.94525399999999,true,"% with health<br/>insurance","Zoom to % with health<br/>insurance","<strong> % with health<br/>insurance <\/strong>","bottomright"]},{"method":"addLegend","args":[{"colors":["#4B0055 , #481763 5.76923076923078%, #006691 29.8076923076923%, #00A492 53.8461538461539%, #6DD05E 77.8846153846154%, #FDE333 "],"labels":["80","85","90","95"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"numeric","title":"% with health<br/>insurance","extra":{"p_1":0.05769230769230783,"p_n":0.7788461538461541},"layerId":null,"className":"info legend","group":"% with health<br/>insurance"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[29.64593300000001,29.655195,29.62175899999999,29.653576,29.677201,29.67492299999997,29.71098999999999,29.711587,29.648227,29.62403699999999],[-82.308131,-82.311972,-82.36174800000001,-82.374377,-82.38177,-82.259461,-82.36743600000001,-82.404031,-82.43289,-82.461844],6,null,"gainesville_sf",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":[0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9,0.9],"fill":true,"fillColor":"#FF0000","fillOpacity":[0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6,0.6]},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 1&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 2&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 3&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 4&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 5&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 6&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 7&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 8&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td> 9&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>patient_id&emsp;<\/th><td>10&emsp;<\/td><\/tr><tr><td>2<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addHomeButton","args":[-82.461844,29.62175899999999,-82.259461,29.711587,true,"gainesville_sf","Zoom to gainesville_sf","<strong> gainesville_sf <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],["% with health<br/>insurance","gainesville_sf"],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addHomeButton","args":[-82.658554,29.41705699999999,-82.049052,29.94525399999999,true,null,"Zoom to full extent","<strong>Zoom full<\/strong>","bottomleft"]}],"limits":{"lat":[29.41705699999999,29.94525399999999],"lng":[-82.658554,-82.049052]},"fitBounds":[29.41705699999999,-82.658554,29.94525399999999,-82.049052,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<p>Figure 7.6: Layered interactive view of patients and Census tracts in Gainesville</p>
</div></div></div>
<div class="task">
<p>Compute the spatial join between simple features <em>gainesville_sf</em> tract geometries and the <em>alachua_insurance_sf</em> data related geometries using <code>sf::st_join()</code> function.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>patients_joined_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_join</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  gainesville_sf,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  alachua_insurance_sf</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Note that <code>sf::st_join()</code> uses <code>sf::st_intersection()</code> by default to match x/y geometries or a point-in-polygon spatial join</span></div></div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.2: Patients dataset after spatial join to Census tracts</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">patient_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_insured</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">pct_insured_moe</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">12001000700</td>
<td style="text-align: right;">81.6</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: left;">POINT (812216.7 73640.25)</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">12001000500</td>
<td style="text-align: right;">91.0</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: left;">POINT (811825.2 74659.57)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">12001001515</td>
<td style="text-align: right;">85.2</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: left;">POINT (807076.4 70862.57)</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">12001001603</td>
<td style="text-align: right;">88.3</td>
<td style="text-align: right;">5.1</td>
<td style="text-align: left;">POINT (805787.7 74365.85)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">12001001100</td>
<td style="text-align: right;">96.2</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: left;">POINT (805023.4 76970.8)</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">12001001902</td>
<td style="text-align: right;">86.0</td>
<td style="text-align: right;">5.9</td>
<td style="text-align: left;">POINT (816865.2 76944.63)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">12001001803</td>
<td style="text-align: right;">92.3</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: left;">POINT (806340.6 80741.36)</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">12001001813</td>
<td style="text-align: right;">97.9</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: left;">POINT (802799 80741.87)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">12001002207</td>
<td style="text-align: right;">95.7</td>
<td style="text-align: right;">2.4</td>
<td style="text-align: left;">POINT (800134.3 73668.88)</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">12001002205</td>
<td style="text-align: right;">96.5</td>
<td style="text-align: right;">1.6</td>
<td style="text-align: left;">POINT (797379.2 70937.49)</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="spatial-joins-and-group-wise-spatial-analysis" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="spatial-joins-and-group-wise-spatial-analysis">7.2.2 Spatial joins and group-wise spatial analysis</h3>
<section id="spatial-join-data-setup" class="level4">
<h4 class="anchored" data-anchor-id="spatial-join-data-setup">7.2.2.1 Spatial join data setup</h4>
<blockquote class="blockquote">
<p>Let’s say that we are interested in analyzing the distributions of neighborhoods (defined here as Census tracts) by Hispanic population for the four largest metropolitan areas in Texas. We’ll use the variable B01003_001 from the 2019 1-year ACS to acquire population data by core-based statistical area (CBSA) along with simple feature geometry which will eventually be used for the spatial join.</p>
</blockquote>
<p>Get the Texas cbsa geometries and merge it with population data. The CRS: NAD83(2011) / Texas Centric Albers Equal Area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tx_cbsa_geo_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_cbsa_sf</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state_filter =</span> <span class="st">"TX"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> F,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">6579</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the “B01003_001” population data for just the top 4 metro GEOID locations in <em>tx_cbsa_geo_sf</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tx_metro_pop_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs1"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"B01003_001E"</span>,<span class="st">"B01003_001M"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="fu">c</span>(<span class="st">"B01003_001E"</span>,<span class="st">"B01003_001M"</span>), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"estimate"</span>, <span class="st">"moe"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">estimate =</span> <span class="fu">as.numeric</span>(estimate), <span class="at">moe =</span> <span class="fu">as.numeric</span>(moe))] <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  .[GEOID <span class="sc">%in%</span> tx_cbsa_geo_sf<span class="sc">$</span>GEOID] <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">order</span>(<span class="sc">-</span>estimate)] <span class="sc">%&gt;%</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Join the dataframe <code>tx_metro_pop_dt</code> with the geometries provided by dataframe <code>tx_cbsa_geo_sf</code> based on their common “GEOID” values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tx_cbsa_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">join_it</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df_1 =</span> tx_cbsa_geo_sf,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df_2 =</span> tx_metro_pop_dt,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">key_1 =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">key_2 =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">variable =</span> <span class="st">"B01003_001"</span>, <span class="at">moe =</span> <span class="cn">NA</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  .[, .(GEOID, NAME, variable, estimate, moe, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  .[<span class="fu">order</span>(<span class="sc">-</span>estimate)] <span class="sc">%&gt;%</span> </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.3: Large CBSAs in Texas</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NAME</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">moe</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">19100</td>
<td style="text-align: left;">Dallas-Fort Worth-Arlington, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">7573136</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1681247 760...</td>
</tr>
<tr class="even">
<td style="text-align: left;">26420</td>
<td style="text-align: left;">Houston-The Woodlands-Sugar Land, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">7066140</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((2009903 730...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1538306 729...</td>
</tr>
<tr class="even">
<td style="text-align: left;">12420</td>
<td style="text-align: left;">Austin-Round Rock-Georgetown, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2227083</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1664195 732...</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="task">
<p>Obtain data on percent of Hispanic by tract from the ACS Data Profile for 2015-2019.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>tx_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"texas"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>pct_hispanic_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5/profile"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">"DP05_0071PE"</span>,<span class="st">"DP05_0071PM"</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, tx_fips)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Obtain the geometries for tracts in the state of Texas and merge the percent of Hispanic data.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pct_hispanic_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> tx_fips,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> pct_hispanic_dt,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">6579</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> F,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(.,<span class="at">old =</span> <span class="fu">c</span>(<span class="st">"DP05_0071PE"</span>,<span class="st">"DP05_0071PM"</span>), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"estimate"</span>,<span class="st">"moe"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">estimate =</span> <span class="fu">as.numeric</span>(estimate), <span class="at">moe =</span> <span class="fu">as.numeric</span>(moe), <span class="at">variable =</span> <span class="st">"DP05_0071PE"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  .[, .(GEOID, NAME, variable, estimate, moe, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.4: Percent Hispanic by Census tract in Texas</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NAME</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">moe</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">48001950100</td>
<td style="text-align: left;">Census Tract 9501, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">12.0</td>
<td style="text-align: right;">5.8</td>
<td style="text-align: left;">MULTIPOLYGON (((1905956 754...</td>
</tr>
<tr class="even">
<td style="text-align: left;">48001950401</td>
<td style="text-align: left;">Census Tract 9504.01, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">25.1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: left;">MULTIPOLYGON (((1892475 752...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48001950402</td>
<td style="text-align: left;">Census Tract 9504.02, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">23.2</td>
<td style="text-align: right;">2.9</td>
<td style="text-align: left;">MULTIPOLYGON (((1879518 752...</td>
</tr>
<tr class="even">
<td style="text-align: left;">48001950500</td>
<td style="text-align: left;">Census Tract 9505, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">38.5</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: left;">MULTIPOLYGON (((1907352 752...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48001950600</td>
<td style="text-align: left;">Census Tract 9506, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">2.7</td>
<td style="text-align: left;">MULTIPOLYGON (((1905825 751...</td>
</tr>
<tr class="even">
<td style="text-align: left;">48001950700</td>
<td style="text-align: left;">Census Tract 9507, Anderson County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">34.6</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: left;">MULTIPOLYGON (((1911228 752...</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="computing-and-visualizing-the-spatial-join" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="computing-and-visualizing-the-spatial-join">7.2.2.2 Computing and visualizing the spatial join</h4>
<p>We have a total of 5254 tracts in the state of Texas with Hispanic percentage. To reduce the number of tracts, select only those tract geometries that are within the four metropolitan areas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>hispanic_by_metro_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_join</span>(pct_hispanic_sf,tx_cbsa_sf, <span class="at">join =</span> st_within, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_tracts"</span>, <span class="st">"_metro"</span>), <span class="at">left =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have reduced the number of tracts to 3189.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.5: Census tracts after spatial join operation</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID_tracts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NAME_tracts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_tracts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate_tracts</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">moe_tracts</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID_metro</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">NAME_metro</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable_metro</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">estimate_metro</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">moe_metro</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">42</td>
<td style="text-align: left;">48013960100</td>
<td style="text-align: left;">Census Tract 9601, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">62.1</td>
<td style="text-align: right;">6.8</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1647089 720...</td>
</tr>
<tr class="even">
<td style="text-align: left;">43</td>
<td style="text-align: left;">48013960201</td>
<td style="text-align: left;">Census Tract 9602.01, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">68.3</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1616126 722...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">44</td>
<td style="text-align: left;">48013960202</td>
<td style="text-align: left;">Census Tract 9602.02, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">76.0</td>
<td style="text-align: right;">3.9</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1618776 721...</td>
</tr>
<tr class="even">
<td style="text-align: left;">45</td>
<td style="text-align: left;">48013960300</td>
<td style="text-align: left;">Census Tract 9603, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">83.1</td>
<td style="text-align: right;">6.2</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1634154 721...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">46</td>
<td style="text-align: left;">48013960401</td>
<td style="text-align: left;">Census Tract 9604.01, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">70.3</td>
<td style="text-align: right;">12.8</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1639999 722...</td>
</tr>
<tr class="even">
<td style="text-align: left;">47</td>
<td style="text-align: left;">48013960402</td>
<td style="text-align: left;">Census Tract 9604.02, Atascosa County, Texas</td>
<td style="text-align: left;">DP05_0071PE</td>
<td style="text-align: right;">46.6</td>
<td style="text-align: right;">5.6</td>
<td style="text-align: left;">41700</td>
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: right;">2550960</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">MULTIPOLYGON (((1638944 720...</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="task">
<p>Plot the density distribution of hispanic percent across the 4 metro areas.</p>
</div>
<p>Reshape <em>hispanic_by_metro_sf</em> from long to wide format:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>hispanic_by_metro_dt <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(hispanic_by_metro_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  .[estimate_tracts <span class="sc">!=</span> <span class="sc">-</span><span class="dv">666666666</span>, .(estimate_tracts, NAME_tracts, NAME_metro)] <span class="sc">%&gt;%</span>   </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>   RcensusPkg<span class="sc">::</span><span class="fu">long_to_wide</span>(<span class="at">id_v =</span> <span class="st">"NAME_tracts"</span>, <span class="at">parameter_col =</span> <span class="st">"NAME_metro"</span>, <span class="at">value_col =</span> <span class="st">"estimate_tracts"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="fu">names</span>(.), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"tracts"</span>, <span class="st">"Austin"</span>, <span class="st">"Dallas"</span>, <span class="st">"Houston"</span>, <span class="st">"SanAntonio"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the densities using <code>RplotterPkg::create_density_ridge_plot()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>RplotterPkg<span class="sc">::</span><span class="fu">create_density_ridge_plot</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> hispanic_by_metro_dt,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">names</span>(hispanic_by_metro_dt)[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_major_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">25</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_title =</span> <span class="st">"Percent Hispanic/Latino in Census tract"</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_major_breaks =</span> <span class="fu">seq</span>(<span class="fl">0.0</span>, <span class="fl">0.03</span>, <span class="fl">0.01</span>),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_limits =</span> <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.03</span>),</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_show_axis =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_widths =</span> <span class="dv">15</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_heights =</span> <span class="fl">6.0</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">density_color =</span> <span class="st">"navy"</span>,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">density_fill =</span> <span class="st">"navy"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.7: Faceted density plot of tract Hispanic populations by CBSA in Texas</figcaption>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Output from a spatial join operation can also be “rolled up” to a larger geography through group-wise data analysis.</p>
</blockquote>
<div class="task">
<p>Using basic <strong>data.table</strong> techniques, group by the 4 Texas metro areas and find their respective hispanic percent median values.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>median_by_metro_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(hispanic_by_metro_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  .[, .(<span class="at">median_est =</span> <span class="fu">median</span>(.SD<span class="sc">$</span>estimate_tracts, <span class="at">na.rm =</span> T), <span class="at">geometry =</span> sf<span class="sc">::</span><span class="fu">st_union</span>(geometry)), by <span class="ot">=</span> NAME_metro] <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.6: Summarized median Hispanic population by metro</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">NAME_metro</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">median_est</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">San Antonio-New Braunfels, TX</td>
<td style="text-align: right;">52.60</td>
<td style="text-align: left;">POLYGON ((1619499 7170517, ...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Houston-The Woodlands-Sugar Land, TX</td>
<td style="text-align: right;">32.40</td>
<td style="text-align: left;">MULTIPOLYGON (((1901162 724...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Austin-Round Rock-Georgetown, TX</td>
<td style="text-align: right;">25.85</td>
<td style="text-align: left;">POLYGON ((1700741 7302450, ...</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dallas-Fort Worth-Arlington, TX</td>
<td style="text-align: right;">22.55</td>
<td style="text-align: left;">POLYGON ((1737530 7565076, ...</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">GEOMETRYCOLLECTION EMPTY</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: left;">GEOMETRYCOLLECTION EMPTY</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="task">
<p>Map the grouped geometry of the “Austin-Round Rock-Georgetown, TX” metro area.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>austin_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(data.table<span class="sc">::</span><span class="fu">as.data.table</span>(median_by_metro_sf)[<span class="dv">3</span>,])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>austin_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> austin_sf, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"white"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>austin_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.8: Dissolved geometry of Census tracts identified within the Austin CBSA</figcaption>
</figure>
</div>
</div></div></div>
</section>
</section>
</section>
<section id="small-area-time-series-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="small-area-time-series-analysis">7.3 Small area time-series analysis</h2>
<div class="task">
<p>Compare Census tract boundaries for a fast-growing area of Gilbert, Arizona (southeast of Phoenix) for 2015 and 2020.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>az_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"AZ"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get 2015 tracts</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>gilbert_2015_express <span class="ot">&lt;-</span> <span class="fu">expression</span>(GEOID <span class="sc">==</span> <span class="st">"04013816000"</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>gilbert_2015_tracts_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> az_fips,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2015</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> gilbert_2015_express,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># get 2020 tracts</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>gilbert_2020_express <span class="ot">&lt;-</span> <span class="fu">expression</span>(GEOID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"04013816001"</span>,<span class="st">"04013816002"</span>,<span class="st">"04013816003"</span>,<span class="st">"04013816005"</span>,<span class="st">"04013816004"</span>))</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>gilbert_2020_tracts_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> az_fips,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> gilbert_2020_express,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot both the 2015 and 2020 tract geometries using <code>RplotterPkg::multi_panel_grid()</code> function:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>gilbert_2015_tracts_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> gilbert_2015_tracts_sf,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="cn">NA</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>gilbert_2020_tracts_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> gilbert_2020_tracts_sf,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="cn">NA</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">plots =</span> <span class="fu">list</span>(gilbert_2015_tracts_plot, gilbert_2020_tracts_plot),</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>RplotterPkg<span class="sc">::</span><span class="fu">multi_panel_grid</span>(</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">layout =</span> layout,</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">c</span>(<span class="st">"2015 tracts"</span>,<span class="st">"2020 tracts"</span>)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.9: Comparison of Census tracts in Gilbert, AZ from the 2010 and 2020</figcaption>
</figure>
</div>
</div></div></div>
<blockquote class="blockquote">
<p>Areal interpolation refers to the allocation of data from one set of zones to a second overlapping set of zones that may or may not perfectly align spatially. In cases of mis-alignment, some type of weighting scheme needs to be specified to determine how to allocate partial data in areas of overlap. Two such approaches for interpolation are outlined here: area-weighted interpolation and population-weighted interpolation.</p>
</blockquote>
<section id="area-weighted-areal-interpolation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="area-weighted-areal-interpolation">Area-weighted areal interpolation</h3>
<blockquote class="blockquote">
<p>This method uses the area of overlap of geometries as the interpolation weights. From a technical standpoint, an intersection is computed between the origin geometries and the destination geometries. Weights are then computed as the proportion of the overall origin area comprised by the intersection.</p>
</blockquote>
<div class="task">
<p>Use area weights to estimate data at 2020 geographies for the Census tract in Gilbert.</p>
</div>
<p>Assign a variable to the land area of Gilbert and create a “proportion” column in the <em>gilbert_2020_tracts_sf</em> dataframe:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>area_2015 <span class="ot">&lt;-</span> gilbert_2015_tracts_sf<span class="sc">$</span>ALAND</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>gilbert_2020_tracts_sf <span class="ot">&lt;-</span> gilbert_2020_tracts_sf <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  .[, proportion <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(ALAND<span class="sc">/</span>area_2015, <span class="at">digits =</span> <span class="dv">3</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot and label the tracts:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>gilbert_2020_tracts_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> gilbert_2020_tracts_sf,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"red"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="cn">NA</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">subtitle =</span> <span class="st">"2020 tracts"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf_label</span>(<span class="at">data =</span> gilbert_2020_tracts_sf, <span class="fu">aes</span>(<span class="at">label =</span> proportion), <span class="at">fun.geometry =</span> st_centroid)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>gilbert_2020_tracts_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.10: Illustration of area weights</figcaption>
</figure>
</div>
</div></div></div>
<div class="task">
<p>Use <code>sf::st_interpolate_aw</code> interpolation method to compare data for Maricopa County, AZ on the number of people working from home in the 2011-2015 ACS (which uses 2010 boundaries) and the 2016-2020 ACS (which uses 2020 boundaries).</p>
</div>
<p>Get both the 2011-2015 and 2016-2020 acs/acs5 data for people working from home (“B08006_017”) for Maricopa County, AZ:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>az_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"AZ"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>az_maricopa_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"AZ"</span>, <span class="at">county =</span> <span class="st">"Maricopa"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>maricopa_fips <span class="ot">&lt;-</span> <span class="fu">substr</span>(az_maricopa_fips,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>wfh_2015_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2015</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="st">"B08006_017E"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, az_fips, <span class="st">"+county:"</span>, maricopa_fips)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="st">"B08006_017E"</span>, <span class="at">new =</span> <span class="st">"worked_at_home"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  .[, worked_at_home <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(worked_at_home)]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>wfh_2020_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="st">"B08006_017E"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, az_fips, <span class="st">"+county:"</span>, maricopa_fips)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="st">"B08006_017E"</span>, <span class="at">new =</span> <span class="st">"worked_at_home"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  .[, worked_at_home <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(worked_at_home)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the tract geographies for the years and join with the above data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>express <span class="ot">&lt;-</span> <span class="fu">expression</span>(COUNTYFP <span class="sc">==</span> maricopa_fips)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>wfh_tracts_2015_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> az_fips,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2015</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> express,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> wfh_2015_dt,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">26949</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  .[, .(worked_at_home, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>wfh_tracts_2020_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> az_fips,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> express,</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> wfh_2020_dt,</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">26949</span>,</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>)<span class="sc">%&gt;%</span> </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  .[, .(worked_at_home, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>sf::st_interpolate_aw</code> to estimate area-weighted interpolation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>wfh_interpolate_aw_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_interpolate_aw</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  wfh_tracts_2015_sf,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  wfh_tracts_2020_sf,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">extensive =</span> <span class="cn">TRUE</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  .[, GEOID <span class="sc">:</span><span class="er">=</span> wfh_2020_dt<span class="sc">$</span>GEOID] <span class="sc">%&gt;%</span> </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Area interplolation using sf::st_interpolate_aw</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">worked_at_home</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">362.94291</td>
<td style="text-align: left;">04013061044</td>
<td style="text-align: left;">POLYGON ((199614.5 327529.9...</td>
</tr>
<tr class="even">
<td style="text-align: right;">154.61054</td>
<td style="text-align: left;">04013061045</td>
<td style="text-align: left;">POLYGON ((225387.6 307155.6...</td>
</tr>
<tr class="odd">
<td style="text-align: right;">67.41170</td>
<td style="text-align: left;">04013061046</td>
<td style="text-align: left;">POLYGON ((232623.7 304703.7...</td>
</tr>
<tr class="even">
<td style="text-align: right;">80.00828</td>
<td style="text-align: left;">04013061047</td>
<td style="text-align: left;">POLYGON ((208921.6 310661.5...</td>
</tr>
<tr class="odd">
<td style="text-align: right;">182.85828</td>
<td style="text-align: left;">04013061048</td>
<td style="text-align: left;">POLYGON ((206044.3 310398.1...</td>
</tr>
<tr class="even">
<td style="text-align: right;">192.20883</td>
<td style="text-align: left;">04013061049</td>
<td style="text-align: left;">POLYGON ((134351 332974, 13...</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section>
<section id="population-weighted-areal-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="population-weighted-areal-interpolation">7.3.2 Population-weighted areal interpolation</h3>
<p>Section has been skipped.</p>
</section>
<section id="making-small-area-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="making-small-area-comparisons">7.3.3 Making small-area comparisons</h3>
<p>Section has been skipped.</p>
</section>
</section>
<section id="distance-and-proximity-analysis" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="distance-and-proximity-analysis">7.4 Distance and proximity analysis</h2>
<div class="task">
<p>Consider accessibility to Level I and Level II trauma hospitals by Census tract in the state of Iowa.</p>
</div>
<p>Get the US hospital locations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>hospitals_file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(here<span class="sc">::</span><span class="fu">here</span>(), <span class="st">"data"</span>, <span class="st">"Hospitals.gz"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>trauma_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">fread</span>(hospitals_file_path) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(., <span class="at">by =</span> <span class="st">"ID"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  .[TRAUMA <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"LEVEL I"</span>, <span class="st">"LEVEL II"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(., <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>,<span class="st">"LATITUDE"</span>), <span class="at">crs=</span>sf<span class="sc">::</span><span class="fu">st_crs</span>(<span class="dv">4269</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the Census tracts for the state of Iowa:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ia_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"Iowa"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>ia_tracts_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> ia_fips,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2019</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> F</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="calculating-distances" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="calculating-distances">7.4.1 Calculating distances</h3>
<blockquote class="blockquote">
<p>To determine accessibility of Iowa Census tracts to Level I or II trauma centers, we need to identify not only those hospitals that are located in Iowa, but also those in other states near to the Iowa border, such as in Omaha, Nebraska and Rock Island, Illinois.</p>
</blockquote>
<p>Apply a distance threshold with <code>sf::st_filter()</code> and <code>st::st_is_within_distance()</code> set at 100km</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ia_trauma_sf <span class="ot">&lt;-</span> trauma_sf <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_filter</span>(ia_tracts_sf, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">.predicate =</span> st_is_within_distance,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">dist =</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(.,sf<span class="sc">::</span><span class="fu">st_crs</span>(<span class="dv">26975</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>ia_tracts_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(ia_tracts_sf, sf<span class="sc">::</span><span class="fu">st_crs</span>(<span class="dv">26975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the Trauma centers located within distance of the Iowa tracts:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ia_tracts_sf,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"gray50"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"gray50"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ia_trauma_sf,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"red"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_size =</span> <span class="dv">4</span>,</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">adding =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.14: Level I or II trauma centers within 100km of Iowa</figcaption>
</figure>
</div>
</div></div></div>
<div class="task">
<p>Calculate the distances from the centroids of Iowa Census tracts (reflecting the center points of each tract geometry) to each trauma center.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>dist_mt <span class="ot">&lt;-</span> ia_tracts_sf <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_centroid</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_distance</span>(ia_trauma_sf) </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>min_dist_v <span class="ot">&lt;-</span> dist_mt <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="dv">1</span>, min) <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.vector</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  magrittr<span class="sc">::</span><span class="fu">divide_by</span>(<span class="dv">1000</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Show the distribution of the minimum distances in a histogram:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>RplotterPkg<span class="sc">::</span><span class="fu">create_histogram_plot</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> <span class="fu">data.frame</span>(<span class="at">min_distance =</span> min_dist_v),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_x =</span> <span class="st">"min_distance"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">bin_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">140</span>, <span class="dv">10</span>),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">140</span>),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_major_breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">140</span>, <span class="dv">20</span>),</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">bar_fill =</span> <span class="st">'green'</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.15: Histogram of minimum distances to trauma centers</figcaption>
</figure>
</div>
</div></div></div>
</section>
<section id="calculating-travel-times" class="level3">
<h3 class="anchored" data-anchor-id="calculating-travel-times">7.4.2 Calculating travel times</h3>
<p>This section is skipped.</p>
</section>
<section id="catchment-areas-with-buffers-and-isochrones" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="catchment-areas-with-buffers-and-isochrones">Catchment areas with buffers and isochrones</h3>
<blockquote class="blockquote">
<p>…you’ll want to analyze accessibility in a more local way. A common use case might involve a study of the demographic characteristics of a hospital catchment area, defined as the area around a hospital from which patients will likely come.</p>
</blockquote>
<div class="task">
<p>Use Iowa Methodist Medical Center in Des Moines as an example and the distance-based approach using a buffer, implemented with the sf::st_buffer().</p>
</div>
<p>Compute the 5k buffer around the Iowa Methodist Medical Center:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>iowa_methodist_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(ia_trauma_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  .[ID <span class="sc">==</span> <span class="dv">9850308</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>iowa_methodist_buf5km_sf <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_buffer</span>(iowa_methodist_sf, <span class="at">dist =</span> <span class="dv">5000</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the buffer with leaflet:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>hospital_icon <span class="ot">&lt;-</span> leaflet<span class="sc">::</span><span class="fu">makeAwesomeIcon</span>(<span class="at">icon =</span> <span class="st">"ios-medical"</span>, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">markerColor =</span> <span class="st">"red"</span>,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">library =</span> <span class="st">"ion"</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>iowa_methodist_buf5km_lf <span class="ot">&lt;-</span> leaflet<span class="sc">::</span><span class="fu">leaflet</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  leaflet<span class="sc">::</span><span class="fu">addTiles</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  leaflet<span class="sc">::</span><span class="fu">addPolygons</span>(<span class="at">data =</span> sf<span class="sc">::</span><span class="fu">st_transform</span>(iowa_methodist_buf5km_sf, <span class="dv">4326</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  leaflet<span class="sc">::</span><span class="fu">addAwesomeMarkers</span>(<span class="at">data =</span> <span class="fu">st_transform</span>(iowa_methodist_sf, <span class="dv">4326</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">icon =</span> hospital_icon)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>iowa_methodist_buf5km_lf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-2c5c46e7fc89944924be" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2c5c46e7fc89944924be">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addPolygons","args":[[[[{"lng":[-93.57385268092064,-93.57393210749622,-93.57417564000056,-93.57458259286835,-93.57515183300754,-93.57588178309842,-93.57677042610372,-93.57781531097541,-93.57901355954056,-93.58036187454557,-93.58185654883501,-93.58349347563838,-93.58526815993532,-93.58717573086682,-93.58921095515737,-93.59136825151079,-93.59364170593935,-93.59602508798406,-93.5985118677816,-93.60109523393091,-93.6037681121114,-93.60652318440161,-93.60935290924681,-93.61224954202125,-93.61520515613034,-93.61821166459602,-93.62126084206767,-93.62434434720026,-93.62745374533976,-93.63058053145588,-93.63371615326118,-93.63685203445546,-93.63997959803359,-93.64309028959519,-93.64617560059467,-93.64922709146951,-93.65223641458616,-93.65519533694203,-93.65809576256396,-93.66092975454298,-93.66368955664709,-93.66636761445419,-93.66895659594866,-93.67144941152637,-93.67383923335416,-93.67611951403173,-93.6782840045052,-93.68032677118363,-93.68224221221182,-93.68402507285461,-93.68567045995015,-93.68717385539213,-93.68853112860312,-93.68973854796387,-93.69079279116626,-93.69169095445984,-93.69243056076539,-93.69300956663146,-93.69342636801289,-93.69367980485383,-93.69376916446028,-93.69369418365113,-93.69345504967944,-93.6930523999194,-93.69248732031731,-93.69176134260927,-93.6908764403103,-93.68983502348452,-93.68863993230822,-93.68729442944201,-93.68580219123091,-93.68416729775521,-93.68239422175766,-93.68048781647637,-93.67845330241563,-93.6762962530902,-93.67402257978118,-93.67163851534561,-93.66915059712319,-93.66656564898767,-93.66389076259222,-93.66113327786063,-93.65830076277885,-93.65540099254301,-93.65244192812239,-93.64943169429743,-93.64637855723453,-93.64329090166092,-93.64017720770377,-93.63704602745933,-93.63390596135807,-93.6307656343929,-93.62763367227784,-93.62451867760461,-93.62142920606468,-93.61837374280434,-93.61536067897954,-93.6123982885768,-93.60949470556598,-93.60665790144905,-93.6038956632684,-93.60121557213624,-93.59862498234568,-93.59613100112163,-93.59374046906827,-93.59145994136716,-93.58929566977859,-93.58725358549528,-93.58533928289589,-93.58355800424263,-93.58191462536472,-93.58041364236594,-93.57905915939249,-93.57785487749317,-93.57680408460139,-93.57590964666532,-93.57517399994839,-93.57459914452005,-93.57418663895241,-93.57393759623557,-93.57385268092064],"lat":[41.58949861571764,41.58714275856984,41.58479325130592,41.58245653269405,41.58013900574004,41.57784702015667,41.57558685498672,41.57336470142683,41.57118664589921,41.56905865341677,41.56698655128694,41.56497601319843,41.56303254373353,41.56116146334789,41.55936789385841,41.55765674447766,41.55603269843326,41.55450020020687,41.55306344342809,41.5517263594548,41.55049260667086,41.5493655605295,41.54834830436917,41.54744362102581,41.54665398526441,41.54598155704951,41.54542817567268,41.54499535475272,41.54468427812137,41.54449579660595,41.54443042571711,41.54448834424784,41.54466939378779,41.54497307915356,41.54539856973449,41.54594470174983,41.54660998141181,41.5473925889857,41.54829038373675,41.54930090975009,41.55042140260906,41.55164879691343,41.55297973461817,41.55441057417019,41.55593740041893,41.55755603527446,41.55926204908439,41.5610507726997,41.56291731019672,41.56485655222167,41.56686318992166,41.56893172942497,41.57105650683164,41.57323170367407,41.57545136280578,41.57770940467563,41.57999964394362,41.58231580639247,41.58465154609037,41.58700046275701,41.58935611928629,41.59171205937783,41.59406182522877,41.59639897523782,41.5987171016727,41.6010098482526,41.60327092759711,41.60549413849368,41.60767338293574,41.60980268288439,41.61187619670731,41.613888235249,41.61583327748792,41.61770598573676,41.61950122034344,41.621214053852,41.62283978458314,41.62437394959746,41.62581233700364,41.62715099757835,41.62838625566415,41.62951471931535,41.63053328966298,41.63143916947259,41.63222987087045,41.6329032222167,41.63345737410569,41.63389080447672,41.63420232282082,41.63439107347114,41.63445653796834,41.63439853649385,41.63421722836674,41.63391311160354,41.63348702154144,41.63294012852917,41.63227393469221,41.63149026978117,41.63059128611522,41.62957945263521,41.62845754808272,41.62722865332478,41.6258961428457,41.62446367543025,41.62293518406417,41.6213148650808,41.61960716658415,41.61781677618106,41.61594860805685,41.61400778943077,41.61199964642933,41.60992968941661,41.60780359782309,41.6056272045149,41.60340647974717,41.60114751474642,41.59885650496665,41.59653973306703,41.59420355165662,41.59185436585524,41.58949861571764]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[41.58944332999999,-93.63381099,{"icon":"ios-medical","markerColor":"red","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"ion"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[41.54443042571711,41.63445653796834],"lng":[-93.69376916446028,-93.57385268092064]}},"evals":[],"jsHooks":[]}</script>
<p>Figure 7.17: Synced map showing buffer catchment areas in Des Moines</p>
</div></div></div>
</section>
<section id="computing-demographic-estimates-for-zones-with-areal-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="computing-demographic-estimates-for-zones-with-areal-interpolation">7.4.4 Computing demographic estimates for zones with areal interpolation</h3>
<p>Note: this section has not been completed.</p>
</section>
</section>
<section id="better-cartography-with-spatial-overlay" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="better-cartography-with-spatial-overlay">7.5 Better cartography with spatial overlay</h2>
<div class="task">
<p>Map the median household income by Census tract in Manhattan (New York County), NY</p>
</div>
<p>Get the median household income data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ny_state_county_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"New York"</span>, <span class="at">county =</span> <span class="st">"New York"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ny_state_fips <span class="ot">&lt;-</span> <span class="fu">substr</span>(ny_state_county_fips, <span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ny_county_fips <span class="ot">&lt;-</span> <span class="fu">substr</span>(ny_state_county_fips, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ny_income_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="st">"B19013_001E"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, ny_state_fips, <span class="st">"+county:"</span>, ny_county_fips)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="st">"B19013_001E"</span>, <span class="at">new =</span> <span class="st">"median_income"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  .[, median_income <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(median_income)] <span class="sc">%&gt;%</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  .[median_income <span class="sc">&gt;</span> <span class="fl">0.0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the New York county tract shapefiles and join with the above income data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>express <span class="ot">&lt;-</span> <span class="fu">expression</span>(COUNTYFP <span class="sc">==</span> ny_county_fips)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>ny_tracts_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> ny_state_fips,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> express,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> ny_income_dt,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  .[, .(median_income, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Map the tract shapefiles and data:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ny_tracts_sf,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"median_income"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">own_scale =</span> T,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>   ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_dollar</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.18: Map of Manhattan with default CB geometries</figcaption>
</figure>
</div>
</div></div></div>
<blockquote class="blockquote">
<p>As illustrated in the graphic, the boundaries of Manhattan include water boundaries - stretching into the Hudson and East Rivers. In turn, a more accurate representation of Manhattan’s land area might be desired.</p>
</blockquote>
<section id="erasing-areas-from-census-polygons" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="erasing-areas-from-census-polygons">7.5.1 “Erasing” areas from Census polygons</h3>
<div class="task">
<p>Remove water area from the Census tracts of New York county.</p>
</div>
<p>Re-define the New York tracts by setting the <em>general</em> parameter to FALSE:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>express <span class="ot">&lt;-</span> <span class="fu">expression</span>(COUNTYFP <span class="sc">==</span> ny_county_fips)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ny_tracts_2_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> ny_state_fips,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> <span class="cn">FALSE</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">6538</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">express =</span> express,</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> ny_income_dt,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> <span class="cn">FALSE</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  .[, .(median_income, geometry)] <span class="sc">%&gt;%</span> </span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use <code>RcensusPkg::remove_area_water()</code> to remove area water from the New York tracts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ny_tracts_without_water_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">remove_area_water</span>(ny_tracts_2_sf, <span class="at">output_dir =</span> output_dir)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Map the New York tracts both with and without water:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ny_tracts_with_water_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ny_tracts_2_sf,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"green"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_legend =</span> F</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>ny_tracts_without_water_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> ny_tracts_without_water_sf,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_fill =</span> <span class="st">"green"</span>,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_legend =</span> F</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>layout <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">plots =</span> <span class="fu">list</span>(ny_tracts_with_water_plot, ny_tracts_without_water_plot),</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">rows =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">cols =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>ny_tracts_multi_plot <span class="ot">&lt;-</span> RplotterPkg<span class="sc">::</span><span class="fu">multi_panel_grid</span>(</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">layout =</span> layout,</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot_titles =</span> <span class="fu">c</span>(<span class="st">"with water"</span>, <span class="st">"without water"</span>)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>ny_tracts_multi_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.19: Map of Manhattan with water areas erased</figcaption>
</figure>
</div>
</div></div></div>
</section>
</section>
<section id="spatial-neighborhoods-and-spatial-weights-matrices" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="spatial-neighborhoods-and-spatial-weights-matrices">7.6 Spatial neighborhoods and spatial weights matrices</h2>
<div class="task">
<p>Explore spatial patterns and spatial clustering of a given demographic attribute (Exploratory Spatial Data Analysis or ESDA).</p>
</div>
<p>As an example, acquire a dataset on median age by Census tract in the Dallas-Fort Worth, TX metropolitan area:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tx_fips <span class="ot">&lt;-</span> usmap<span class="sc">::</span><span class="fu">fips</span>(<span class="at">state =</span> <span class="st">"TX"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>tx_tracts_median_age_dt <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">get_vintage_data</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset =</span> <span class="st">"acs/acs5"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vars =</span> <span class="st">"B01002_001E"</span>,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">region =</span> <span class="st">"tract:*"</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">regionin =</span> <span class="fu">paste0</span>(<span class="st">"state:"</span>, tx_fips)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="st">"B01002_001E"</span>, <span class="at">new =</span> <span class="st">"median_age"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  .[, .(NAME, tract, <span class="at">median_age =</span> <span class="fu">as.numeric</span>(median_age), GEOID)] <span class="sc">%&gt;%</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  .[median_age <span class="sc">&gt;</span> <span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the geometries for the Dallas area CBSA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>dallas_cbsa_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_cbsa_sf</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state_filter =</span> <span class="st">"TX"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">city_filter =</span> <span class="st">"Dallas-Fort Worth-Arlington"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> T,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">32138</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> F,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Get the Texas Census tracts and age data for just within the Dallas CBSA geometries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_sf <span class="ot">&lt;-</span> RcensusPkg<span class="sc">::</span><span class="fu">tiger_tracts_sf</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> tx_fips,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vintage =</span> <span class="dv">2020</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">general =</span> T,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">transform_crs =</span> <span class="dv">32138</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile =</span> tx_tracts_median_age_dt,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">datafile_key =</span> <span class="st">"GEOID"</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> output_dir,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">check_na =</span> T,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_info =</span> F</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>sf<span class="sc">::</span><span class="fu">st_filter</span>(dallas_cbsa_sf, <span class="at">.predicate =</span> st_within)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the Dallas area tracts with their color coded median age:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_plot <span class="ot">&lt;-</span> RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> dallas_tracts_median_age_sf,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"median_age"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">own_scale =</span> T,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">na.value =</span> <span class="st">"white"</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div></div></div>
<section id="understanding-spatial-neighborhoods" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="understanding-spatial-neighborhoods">7.6.1 Understanding spatial neighborhoods</h3>
<div class="task">
<p>Using <code>spdep::poly2nb()</code> find polygons in the above Dallas median age shapefile that share at least one vertex to be considered neighbors.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>neighbors_lst <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">poly2nb</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pl =</span> dallas_tracts_median_age_sf, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">queen =</span> <span class="cn">TRUE</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(neighbors_lst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 1699 
Number of nonzero links: 10930 
Percentage nonzero weights: 0.378646 
Average number of links: 6.433196 
Link number distribution:

  2   3   4   5   6   7   8   9  10  11  12  13  14  15  17 
  8  52 172 305 396 343 218 112  44  29  11   5   2   1   1 
8 least connected regions:
707 1070 1097 1143 1239 1415 1503 1689 with 2 links
1 most connected region:
685 with 17 links</code></pre>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Tract’s average number of neighbors: 6.4; Minimum: 2; Maximum: 17</span></div></div>
<div class="task">
<p>Show the neighbors of the Census tract at row index 1:</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>neighbors_lst[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  3  8 73 77</code></pre>
</div>
</div>
</section>
<section id="generating-the-spatial-weights-matrix" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="generating-the-spatial-weights-matrix">7.6.2 Generating the spatial weights matrix</h3>
<blockquote class="blockquote">
<p>To perform exploratory spatial data analysis, we can convert the neighbors list object into spatial weights. Spatial weights define how metrics associated with a feature’s neighbors should be weighted.</p>
</blockquote>
<div class="task">
<p>Convert the above neighbors list to a weights matrix.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>weights_lst <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">nb2listw</span>(</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">neighbours =</span> neighbors_lst, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">style =</span> <span class="st">"W"</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>weights_lst<span class="sc">$</span>weights[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2 0.2 0.2 0.2 0.2</code></pre>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">Row index 1 has five neighbors, each neighbor is assigned the weight 0.2</span></div></div>
</section>
</section>
<section id="global-and-local-spatial-autocorrelation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="global-and-local-spatial-autocorrelation">7.7 Global and local spatial autocorrelation</h2>
<blockquote class="blockquote">
<p>With respect to the exploratory spatial analysis of Census data, we might be interested in the degree to which a given Census variable clusters spatially, and subsequently where those clusters are found.</p>
</blockquote>
<section id="spatial-lags-and-morans-i" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="spatial-lags-and-morans-i">7.7.1 Spatial lags and Moran’s I</h3>
<div class="task">
<p>Compute the average median age for the neighbors of each Census tract in the Dallas-Fort Worth metropolitan area.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lag_v <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">lag.listw</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> weights_lst,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> dallas_tracts_median_age_sf<span class="sc">$</span>median_age</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Draw a scatterplot of the ACS estimate vs.&nbsp;its lagged mean to do a preliminary assessment of spatial clustering in the data.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(dallas_tracts_median_age_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  .[, lag_median_age <span class="sc">:</span><span class="er">=</span> lag_v]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>RplotterPkg<span class="sc">::</span><span class="fu">create_scatter_plot</span>(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> dt,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_x =</span> <span class="st">"median_age"</span>,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_y =</span> <span class="st">"lag_median_age"</span>,</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_title =</span> <span class="st">"Median Age"</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_title =</span> <span class="st">"Spatial lag, median age"</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.21: Scatterplot of median age relative to its spatial lag</figcaption>
</figure>
</div>
</div></div></div>
<div class="task">
<p>Compute Moran’s I, which is similar to a correlation coefficient but for the relationship between observations and their neighbors.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>spdep<span class="sc">::</span><span class="fu">moran.test</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dallas_tracts_median_age_sf<span class="sc">$</span>median_age, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">listw =</span> weights_lst</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  dallas_tracts_median_age_sf$median_age  
weights: weights_lst    

Moran I statistic standard deviate = 21.275, p-value &lt; 2.2e-16
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     0.2926713016     -0.0005889282      0.0001900099 </code></pre>
</div>
</div>
<div class="page-columns page-full"><p></p><div class="no-row-height column-margin column-container"><span class="">The Moran’s <em>I</em> statistic of 0.29 is positive, and the small <em>p</em>-value suggests that we reject the null hypothesis of spatial randomness in the dataset</span></div></div>
</section>
<section id="local-spatial-autocorrelation" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="local-spatial-autocorrelation">7.7.2 Local spatial autocorrelation</h3>
<blockquote class="blockquote">
<p>Local measures of spatial autocorrelation disaggregate global results to identify “hot spots” of similar values within a given spatial dataset.</p>
</blockquote>
<blockquote class="blockquote">
<p>The equation (Gi*) computes a ratio of the weighted average of the neighborhood values to the total sum of values for the dataset. Results are returned as z-scores.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>localg_weights_lst <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">nb2listw</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  spdep<span class="sc">::</span><span class="fu">include.self</span>(neighbors_lst)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>localG_v <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">localG</span>(</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dallas_tracts_median_age_sf<span class="sc">$</span>median_age, </span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">listw =</span> localg_weights_lst</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="task">
<p>Create a cholorplath map of the Dallas tracts based on their respective weighted neighbor tracts average of median age.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_localG_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(dallas_tracts_median_age_sf) <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  .[, localG <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(localG_v)] <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> dallas_tracts_localG_sf,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"localG"</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">own_scale =</span> T,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdYlBu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.22: Map of local Gi* scores</figcaption>
</figure>
</div>
</div></div></div>
<div class="task">
<p>Use the Gi* z-scores from <em>dallas_tracts_localG_sf</em> to define values greater than 2.5 as a “High cluster” and below -2.5 as “Low cluster” and map these areas.</p>
</div>
<p>Add a column indicating the 3 levels:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_localG_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(dallas_tracts_localG_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  .[, hotspot <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    localG <span class="sc">&gt;=</span> <span class="fl">2.576</span>, <span class="st">"High cluster"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    localG <span class="sc">&lt;=</span> <span class="sc">-</span><span class="fl">2.576</span>, <span class="st">"Low cluster"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">default =</span> <span class="st">"Not significant"</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  ] <span class="sc">%&gt;%</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  .[, hotspot <span class="sc">:</span><span class="er">=</span> <span class="fu">as.factor</span>(hotspot)] <span class="sc">%&gt;%</span> </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot and color code the levels of cluster:</p>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"grey"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(colors) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"High cluster"</span>, <span class="st">"Low cluster"</span>, <span class="st">"Not significant"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> dallas_tracts_localG_sf,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"hotspot"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf_color =</span> <span class="st">"white"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_values =</span> colors,</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale_labels =</span> <span class="fu">names</span>(colors),</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T,</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_color =</span> <span class="st">"white"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel_border_color =</span> <span class="st">"white"</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.23: Map of local Gi* scores with significant clusters highlighted</figcaption>
</figure>
</div>
</div></div></div>
<blockquote class="blockquote">
<p>The red areas on the resulting map are representative of “high” clustering of median age, where neighborhoods with older populations are surrounded by other older-age neighbors. “Low” clusters are represented in blue, which reflect clustering of Census tracts with comparatively youthful populations.</p>
</blockquote>
</section>
<section id="identifying-clusters-and-spatial-outliers-with-local-indicators-of-spatial-association-lisa" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="identifying-clusters-and-spatial-outliers-with-local-indicators-of-spatial-association-lisa">7.7.3 Identifying clusters and spatial outliers with local indicators of spatial association (LISA)</h3>
<blockquote class="blockquote">
<p>One of the major benefits of using LISA for exploratory analysis is its ability to identify both spatial clusters, where observations are surrounded by similar values, and spatial outliers, where observations are surrounded by dissimilar values.</p>
</blockquote>
<div class="task">
<p>Compute the LISA values for median age among the Dallas tracts.</p>
</div>
<p>Set a random number seed and convert the median age to a z-score using <em>scale()</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1983</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(dallas_tracts_median_age_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  .[, scaled_median_age <span class="sc">:</span><span class="er">=</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(median_age))] <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compute LISA with <em>localmoran_perm()</em> for the scaled value of median age:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_LISA_dt <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">localmoran_perm</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> dallas_tracts_median_age_sf<span class="sc">$</span>scaled_median_age,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">listw =</span> weights_lst,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">999</span>L,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">setnames</span>(<span class="at">old =</span> <span class="fu">colnames</span>(.), <span class="at">new =</span> <span class="fu">c</span>(<span class="st">"local_i"</span>,<span class="st">"exp_i"</span>,<span class="st">"var_i"</span>,<span class="st">"z_i"</span>,<span class="st">"p_i"</span>,<span class="st">"p_i_sim"</span>,<span class="st">"pi_sim_folded"</span>,<span class="st">"skewness"</span>,<span class="st">"kurtosis"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compute the lagged value of scaled_median_age using <em>spdep::lag.listw()</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>lag_scaled_median_age_v <span class="ot">&lt;-</span> spdep<span class="sc">::</span><span class="fu">lag.listw</span>(</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> weights_lst,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> dallas_tracts_median_age_sf<span class="sc">$</span>scaled_median_age</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Combine vectors/columns:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_LISA_dt <span class="ot">&lt;-</span> dallas_tracts_median_age_LISA_dt <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  .[, <span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">GEOID =</span> dallas_tracts_median_age_sf<span class="sc">$</span>GEOID, <span class="at">scaled_median_age =</span> dallas_tracts_median_age_sf<span class="sc">$</span>scaled_median_age, <span class="at">lagged_median_age =</span> lag_scaled_median_age_v)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table 7.8: Local Moran’s I results</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">GEOID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">scaled_median_age</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lagged_median_age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">48085030101</td>
<td style="text-align: right;">-0.6163538</td>
<td style="text-align: right;">0.2278064</td>
</tr>
<tr class="even">
<td style="text-align: left;">48085030102</td>
<td style="text-align: right;">1.3837469</td>
<td style="text-align: right;">0.0925054</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48085030201</td>
<td style="text-align: right;">-0.1457419</td>
<td style="text-align: right;">-0.0254149</td>
</tr>
<tr class="even">
<td style="text-align: left;">48085030202</td>
<td style="text-align: right;">0.8837218</td>
<td style="text-align: right;">-0.1709532</td>
</tr>
<tr class="odd">
<td style="text-align: left;">48085030204</td>
<td style="text-align: right;">-0.4987008</td>
<td style="text-align: right;">-0.2290794</td>
</tr>
<tr class="even">
<td style="text-align: left;">48085030205</td>
<td style="text-align: right;">-0.8369531</td>
<td style="text-align: right;">0.0564742</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="task">
<p>From <em>dallas_tracts_median_age_LISA_dt</em> complete a LISA quadrant scatterplot.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_LISA_dt[, lisa_cluster <span class="sc">:</span><span class="er">=</span> <span class="fu">fcase</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  p_i <span class="sc">&gt;=</span> <span class="fl">0.05</span>, <span class="st">"Not significant"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  scaled_median_age <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> local_i <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"High-high"</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  scaled_median_age <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> local_i <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"High-low"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  scaled_median_age <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> local_i <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Low-low"</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  scaled_median_age <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> local_i <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"Low-high"</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)]</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>color_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">High-high</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">High-low</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"pink"</span>,</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">Low-low</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"blue"</span>,</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">Low-high</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"lightblue"</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">`</span><span class="at">Not significant</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"white"</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>RplotterPkg<span class="sc">::</span><span class="fu">create_scatter_plot</span>(</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">df =</span> dallas_tracts_median_age_LISA_dt,</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_x =</span> <span class="st">"scaled_median_age"</span>,</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_y =</span> <span class="st">"lagged_median_age"</span>,</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"lisa_cluster"</span>,</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">x_title =</span> <span class="st">"Median age (z-score)"</span>,</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">y_title =</span> <span class="st">"Spatial lag of median age (z-score)"</span>,</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">pts_size =</span> <span class="dv">2</span></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.24: LISA quadrant scatterplot</figcaption>
</figure>
</div>
</div></div></div>
<blockquote class="blockquote">
<p>Observations falling in the top-right quadant represent “high-high” clusters, where Census tracts with higher than median age are also surrounded by Census tracts with older populations. The bottom-left quadrant also represents spatial clusters, but instead includes lower median age tracts that are surrounded by tracts with similarly low median ages. The top-left and bottom-right quadrants are home to spatial outliers, where values are dissimilar from their neighbors.</p>
</blockquote>
<div class="task">
<p>Map the cluster areas.</p>
</div>
<div class="cell page-columns page-full">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>dallas_tracts_median_age_sf <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">as.data.table</span>(dallas_tracts_median_age_sf) <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  .[, lisa_cluster <span class="sc">:</span><span class="er">=</span> dallas_tracts_median_age_LISA_dt<span class="sc">$</span>lisa_cluster] <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(.)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>RspatialPkg<span class="sc">::</span><span class="fu">get_geom_sf</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sf =</span> dallas_tracts_median_age_sf,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">aes_fill =</span> <span class="st">"lisa_cluster"</span>,</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">own_scale =</span> T,</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_x_tics =</span> T,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hide_y_tics =</span> T</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="7_spatial_analysis_with_census_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Figure 7.25: LISA cluster map</figcaption>
</figure>
</div>
</div></div></div>
<blockquote class="blockquote">
<p>Older clusters are colored red; Younger clusters are dark blue; low-high clusters are Census tracts with large quantities of multifamily housing adjacent to predominantly single-family neighborhoods.</p>
</blockquote>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>